import{_ as n,D as t,c as l,I as p,a as s,a4 as i,l as e,o as r}from"./chunks/framework.fDB-PECO.js";const b=JSON.parse('{"title":"Working with window functions","description":"","frontmatter":{"breadcrumbs":{"/getting-started/index.md":[{"title":"Getting Started"}],"/getting-started/what-is-metakraftwerk.md":[{"link":"/getting-started/","title":"Getting Started"},{"title":"What is MetaKraftwerk?"}],"/getting-started/about-metadata.md":[{"link":"/getting-started/","title":"Getting Started"},{"title":"About Metadata"}],"/guides/index.md":[{"title":"Guides"}],"/guides/pattern_development/index.md":[{"link":"/guides/","title":"Guides"},{"title":"Pattern Development"}],"/guides/pattern_development/what-is-a-pattern.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"title":"What is a Pattern?"}],"/guides/pattern_development/integrations/index.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"title":"Integrations"}],"/guides/pattern_development/integrations/informatica.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"link":"/guides/pattern_development/integrations/","title":"Integrations"},{"title":"Informatica"}],"/guides/pattern_development/integrations/snowflake.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"link":"/guides/pattern_development/integrations/","title":"Integrations"},{"title":"Snowflake"}],"/guides/pattern_development/integrations/databricks.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"link":"/guides/pattern_development/integrations/","title":"Integrations"},{"title":"Databricks"}],"/guides/pattern_development/integrations/synapse.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"link":"/guides/pattern_development/integrations/","title":"Integrations"},{"title":"Azure Synapse"}],"/guides/pattern_development/integrations/fabric.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"link":"/guides/pattern_development/integrations/","title":"Integrations"},{"title":"Microsoft Fabric"}],"/guides/pattern_development/creating-a-pattern.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"title":"Creating a pattern"}],"/guides/pattern_development/instance-metadata-schema.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"title":"Instance Metadata Schema"}],"/guides/pattern_development/file-templates.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"title":"File Templates"}],"/guides/pattern_development/modularity.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"title":"Modularity with Reusable Expressions"}],"/guides/pattern_development/pattern-versioning.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/pattern_development/","title":"Pattern Development"},{"title":"Pattern Versioning"}],"/guides/instance_metadata/index.md":[{"link":"/guides/","title":"Guides"},{"title":"Instance Metadata"}],"/guides/instance_metadata/release_management/index.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/instance_metadata/","title":"Instance Metadata"},{"title":"Release Management"}],"/guides/deployments/index.md":[{"link":"/guides/","title":"Guides"},{"title":"Deployments"}],"/guides/deployments/api.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/deployments/","title":"Deployments"},{"title":"API"}],"/guides/deployments/database.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/deployments/","title":"Deployments"},{"title":"Database"}],"/guides/deployments/git.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/deployments/","title":"Deployments"},{"title":"Git"}],"/guides/deployments/group.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/deployments/","title":"Deployments"},{"title":"Group"}],"/guides/sql_guide/index.md":[{"link":"/guides/","title":"Guides"},{"title":"SQL Guide"}],"/guides/sql_guide/basics.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/sql_guide/","title":"SQL Guide"},{"title":"Basics"}],"/guides/sql_guide/joins.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/sql_guide/","title":"SQL Guide"},{"title":"Joins"}],"/guides/sql_guide/subqueries.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/sql_guide/","title":"SQL Guide"},{"title":"Subqueries"}],"/guides/sql_guide/querying_hierarchical_data.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/sql_guide/","title":"SQL Guide"},{"title":"Querying Hierarchical Data"}],"/guides/sql_guide/common_table_expressions.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/sql_guide/","title":"SQL Guide"},{"title":"Common Table Expressions (CTE)"}],"/guides/sql_guide/window_functions.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/sql_guide/","title":"SQL Guide"},{"title":"Window Functions"}],"/guides/scripting_guide/index.md":[{"link":"/guides/","title":"Guides"},{"title":"Scripting Guide"}],"/guides/scripting_guide/blocks.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/scripting_guide/","title":"Scripting Guide"},{"title":"Blocks"}],"/guides/scripting_guide/variables.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/scripting_guide/","title":"Scripting Guide"},{"title":"Variables"}],"/guides/scripting_guide/returning_a_value.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/scripting_guide/","title":"Scripting Guide"},{"title":"Returning a value"}],"/guides/scripting_guide/conditional_logic.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/scripting_guide/","title":"Scripting Guide"},{"title":"Conditional logic"}],"/guides/scripting_guide/loops.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/scripting_guide/","title":"Scripting Guide"},{"title":"Loops"}],"/guides/scripting_guide/resultsets.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/scripting_guide/","title":"Scripting Guide"},{"title":"RESULTSETs"}],"/guides/scripting_guide/exceptions.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/scripting_guide/","title":"Scripting Guide"},{"title":"Exceptions"}],"/guides/scripting_guide/examples_common_use_cases.md":[{"link":"/guides/","title":"Guides"},{"link":"/guides/scripting_guide/","title":"Scripting Guide"},{"title":"Examples / Common Use cases"}],"/reference/index.md":[{"title":"Reference"}],"/reference/general/index.md":[{"link":"/reference/","title":"Reference"},{"title":"General"}],"/reference/general/login_logout.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/general/","title":"General"},{"title":"Login / Logout"}],"/reference/general/application_overview.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/general/","title":"General"},{"title":"Application Overview"}],"/reference/general/project_selection.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/general/","title":"General"},{"title":"Project Selection"}],"/reference/general/profile.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/general/","title":"General"},{"title":"Profile"}],"/reference/general/read_only_mode.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/general/","title":"General"},{"title":"Read-Only Mode"}],"/reference/administration/index.md":[{"link":"/reference/","title":"Reference"},{"title":"Administration"}],"/reference/administration/project_definition.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"title":"Project Definition"}],"/reference/administration/user_management.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"title":"User Management"}],"/reference/administration/pattern_definition.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"title":"Pattern Definition"}],"/reference/administration/release_management.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"title":"Release Management"}],"/reference/administration/agents.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"title":"Agents"}],"/reference/administration/label_definition.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"title":"Label Definition"}],"/reference/administration/connections/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"title":"Connections"}],"/reference/administration/connections/rest_api.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"REST API"}],"/reference/administration/connections/informatica.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Informatica"}],"/reference/administration/connections/azure_synapse_analytics.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Azure Synapse Analytics"}],"/reference/administration/connections/microsoft_fabric.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Microsoft Fabric"}],"/reference/administration/connections/snowflake_sql.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Snowflake (SQL)"}],"/reference/administration/connections/snowflake_api.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Snowflake (API)"}],"/reference/administration/connections/salesforce.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Salesforce"}],"/reference/administration/connections/postgres.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"PostgreSQL"}],"/reference/administration/connections/aws_redshift.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"AWS Redshift"}],"/reference/administration/connections/gcp_bigquery.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"GCP BigQuery"}],"/reference/administration/connections/apache_hive.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Apache Hive"}],"/reference/administration/connections/databricks_sql.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Databricks (SQL)"}],"/reference/administration/connections/databricks_api.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Databricks (API)"}],"/reference/administration/connections/sql_server.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"SQL Server"}],"/reference/administration/connections/oracle.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Oracle"}],"/reference/administration/connections/mysql.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"MySQL"}],"/reference/administration/connections/mariadb.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"MariaDB"}],"/reference/administration/connections/db2.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Db2"}],"/reference/administration/connections/flat_file.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Flat File"}],"/reference/administration/connections/powercenter.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"PowerCenter"}],"/reference/administration/connections/git.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/administration/","title":"Administration"},{"link":"/reference/administration/connections/","title":"Connections"},{"title":"Git"}],"/reference/patterns/index.md":[{"link":"/reference/","title":"Reference"},{"title":"Patterns"}],"/reference/patterns/documentation.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"title":"Documentation"}],"/reference/patterns/pattern_upload.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"title":"Pattern Upload"}],"/reference/patterns/sections/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"title":"Sections"}],"/reference/patterns/sections/functional_roles.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"Functional Roles"}],"/reference/patterns/sections/instance_properties.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"Instance Properties"}],"/reference/patterns/sections/constraints.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"Constraints"}],"/reference/patterns/sections/datatypes.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"Datatypes"}],"/reference/patterns/sections/files.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"Files"}],"/reference/patterns/sections/reusable_expressions.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"Reusable Expressions"}],"/reference/patterns/sections/deployments.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"Deployments"}],"/reference/patterns/sections/history.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"History"}],"/reference/patterns/sections/labels.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"Labels"}],"/reference/patterns/sections/variables.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/sections/","title":"Sections"},{"title":"Variables"}],"/reference/patterns/editors/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"title":"Editors"}],"/reference/patterns/editors/file_editor.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/editors/","title":"Editors"},{"title":"File Editor"}],"/reference/patterns/editors/reusable_expression_editor.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/editors/","title":"Editors"},{"title":"Reusable Expression Editor"}],"/reference/patterns/editors/naming_editor.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/editors/","title":"Editors"},{"title":"Naming Editor"}],"/reference/patterns/editors/port_editor.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/editors/","title":"Editors"},{"title":"Port Editor"}],"/reference/patterns/editors/expression_editor.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/editors/","title":"Editors"},{"title":"Expression Editor"}],"/reference/patterns/editors/property_editor.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/editors/","title":"Editors"},{"title":"Property Editor"}],"/reference/patterns/editors/lookup_editor.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/patterns/","title":"Patterns"},{"link":"/reference/patterns/editors/","title":"Editors"},{"title":"Lookup Editor"}],"/reference/instances/index.md":[{"link":"/reference/","title":"Reference"},{"title":"Instances"}],"/reference/instances/table_editor.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"title":"Table Editor"}],"/reference/instances/deletion.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"title":"Deletion"}],"/reference/instances/historization.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"title":"Historization"}],"/reference/instances/validation.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"title":"Validation / Constraints"}],"/reference/instances/filtering.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"title":"Filtering"}],"/reference/instances/upload.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"title":"Upload"}],"/reference/instances/download.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"title":"Download"}],"/reference/instances/release_management/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"title":"Release Management"}],"/reference/instances/release_management/working.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"link":"/reference/instances/release_management/","title":"Release Management"},{"title":"Working"}],"/reference/instances/release_management/delete_restore.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"link":"/reference/instances/release_management/","title":"Release Management"},{"title":"Delete & Restore"}],"/reference/instances/release_management/commit_graph.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"link":"/reference/instances/release_management/","title":"Release Management"},{"title":"Commit graph"}],"/reference/instances/release_management/release_group.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"link":"/reference/instances/release_management/","title":"Release Management"},{"title":"Release Group"}],"/reference/instances/release_management/merge.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"link":"/reference/instances/release_management/","title":"Release Management"},{"title":"Merge"}],"/reference/instances/release_management/release_selection.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"link":"/reference/instances/release_management/","title":"Release Management"},{"title":"Release Selection"}],"/reference/instances/release_management/instance_versioning.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"link":"/reference/instances/release_management/","title":"Release Management"},{"title":"Instance Versioning"}],"/reference/instances/release_management/adding_to_release.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/instances/","title":"Instances"},{"link":"/reference/instances/release_management/","title":"Release Management"},{"title":"Adding To Release"}],"/reference/builds/index.md":[{"link":"/reference/","title":"Reference"},{"title":"Builds"}],"/reference/builds/start_of_a_new_build.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/builds/","title":"Builds"},{"title":"Start of a new build"}],"/reference/builds/build_result_download.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/builds/","title":"Builds"},{"title":"Build result download"}],"/reference/builds/instance_metadata_historization.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/builds/","title":"Builds"},{"title":"Instance historization"}],"/reference/projects/index.md":[{"link":"/reference/","title":"Reference"},{"title":"Projects"}],"/reference/projects/delivery_reports.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/projects/","title":"Projects"},{"title":"Delivery reports"}],"/reference/projects/savings_analysis.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/projects/","title":"Projects"},{"title":"Savings analysis"}],"/reference/projects/project_level_labels.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/projects/","title":"Projects"},{"title":"Project level labels"}],"/reference/meta_database/index.md":[{"link":"/reference/","title":"Reference"},{"title":"Meta Database"}],"/reference/meta_database/sql_datatype_reference/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"title":"SQL Datatype Reference"}],"/reference/meta_database/sql_command_reference/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"title":"SQL Command Reference"}],"/reference/meta_database/sql_command_reference/query_syntax/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"title":"Query Syntax"}],"/reference/meta_database/sql_command_reference/query_syntax/select.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"SELECT"}],"/reference/meta_database/sql_command_reference/query_syntax/with.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"WITH"}],"/reference/meta_database/sql_command_reference/query_syntax/into.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"INTO"}],"/reference/meta_database/sql_command_reference/query_syntax/from.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"FROM"}],"/reference/meta_database/sql_command_reference/query_syntax/connect_by.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"CONNECT BY"}],"/reference/meta_database/sql_command_reference/query_syntax/join.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"JOIN"}],"/reference/meta_database/sql_command_reference/query_syntax/where.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"WHERE"}],"/reference/meta_database/sql_command_reference/query_syntax/group_by.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"GROUP BY"}],"/reference/meta_database/sql_command_reference/query_syntax/having.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"HAVING"}],"/reference/meta_database/sql_command_reference/query_syntax/order_by.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"ORDER BY"}],"/reference/meta_database/sql_command_reference/query_syntax/limit.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_syntax/","title":"Query Syntax"},{"title":"LIMIT"}],"/reference/meta_database/sql_command_reference/query_operators/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"title":"Query Operators"}],"/reference/meta_database/sql_command_reference/query_operators/arithmetic.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_operators/","title":"Query Operators"},{"title":"Arithmetic"}],"/reference/meta_database/sql_command_reference/query_operators/comparison.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_operators/","title":"Query Operators"},{"title":"Comparison"}],"/reference/meta_database/sql_command_reference/query_operators/logical.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_operators/","title":"Query Operators"},{"title":"Logical"}],"/reference/meta_database/sql_command_reference/query_operators/set_operators.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_operators/","title":"Query Operators"},{"title":"Set Operators"}],"/reference/meta_database/sql_command_reference/query_operators/subquery.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/query_operators/","title":"Query Operators"},{"title":"Subquery"}],"/reference/meta_database/sql_command_reference/general_ddl/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"title":"General DDL"}],"/reference/meta_database/sql_command_reference/general_ddl/create_table.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_ddl/","title":"General DDL"},{"title":"CREATE TABLE"}],"/reference/meta_database/sql_command_reference/general_ddl/alter_table.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_ddl/","title":"General DDL"},{"title":"ALTER TABLE"}],"/reference/meta_database/sql_command_reference/general_ddl/drop_table.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_ddl/","title":"General DDL"},{"title":"DROP TABLE"}],"/reference/meta_database/sql_command_reference/general_ddl/create_view.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_ddl/","title":"General DDL"},{"title":"CREATE VIEW"}],"/reference/meta_database/sql_command_reference/general_ddl/drop_view.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_ddl/","title":"General DDL"},{"title":"DROP VIEW"}],"/reference/meta_database/sql_command_reference/general_ddl/create_procedure.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_ddl/","title":"General DDL"},{"title":"CREATE PROCEDURE"}],"/reference/meta_database/sql_command_reference/general_ddl/drop_procedure.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_ddl/","title":"General DDL"},{"title":"DROP PROCEDURE"}],"/reference/meta_database/sql_command_reference/general_ddl/comment.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_ddl/","title":"General DDL"},{"title":"COMMENT"}],"/reference/meta_database/sql_command_reference/general_dml/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"title":"General DML"}],"/reference/meta_database/sql_command_reference/general_dml/insert.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_dml/","title":"General DML"},{"title":"INSERT"}],"/reference/meta_database/sql_command_reference/general_dml/merge.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_dml/","title":"General DML"},{"title":"MERGE"}],"/reference/meta_database/sql_command_reference/general_dml/update.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_dml/","title":"General DML"},{"title":"UPDATE"}],"/reference/meta_database/sql_command_reference/general_dml/delete.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_dml/","title":"General DML"},{"title":"DELETE"}],"/reference/meta_database/sql_command_reference/general_dml/truncate.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/sql_command_reference/","title":"SQL Command Reference"},{"link":"/reference/meta_database/sql_command_reference/general_dml/","title":"General DML"},{"title":"TRUNCATE"}],"/reference/meta_database/function_reference/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"title":"Function Reference"}],"/reference/meta_database/function_reference/abs.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"ABS"}],"/reference/meta_database/function_reference/acos.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"ACOS"}],"/reference/meta_database/function_reference/any_value.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"ANY_VALUE"}],"/reference/meta_database/function_reference/ascii.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"ASCII"}],"/reference/meta_database/function_reference/asin.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"ASIN"}],"/reference/meta_database/function_reference/atan.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"ATAN"}],"/reference/meta_database/function_reference/atan2.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"ATAN2"}],"/reference/meta_database/function_reference/avg.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"AVG"}],"/reference/meta_database/function_reference/ceil.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"CEIL"}],"/reference/meta_database/function_reference/chr.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"CHR"}],"/reference/meta_database/function_reference/coalesce.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"COALESCE"}],"/reference/meta_database/function_reference/concat.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"CONCAT"}],"/reference/meta_database/function_reference/cos.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"COS"}],"/reference/meta_database/function_reference/cosh.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"COSH"}],"/reference/meta_database/function_reference/count.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"COUNT"}],"/reference/meta_database/function_reference/current_release.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"CURRENT_RELEASE"}],"/reference/meta_database/function_reference/current_user.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"CURRENT_USER"}],"/reference/meta_database/function_reference/decode.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"DECODE"}],"/reference/meta_database/function_reference/dense_rank.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"DENSE_RANK"}],"/reference/meta_database/function_reference/exp.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"EXP"}],"/reference/meta_database/function_reference/first_value.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"FIRST_VALUE"}],"/reference/meta_database/function_reference/floor.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"FLOOR"}],"/reference/meta_database/function_reference/greatest.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"GREATEST"}],"/reference/meta_database/function_reference/in.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"IN & [NOT] IN"}],"/reference/meta_database/function_reference/initcap.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"INITCAP"}],"/reference/meta_database/function_reference/instr.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"INSTR"}],"/reference/meta_database/function_reference/is_null.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"IS [NOT] NULL"}],"/reference/meta_database/function_reference/lag.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LAG"}],"/reference/meta_database/function_reference/last_value.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LAST_VALUE"}],"/reference/meta_database/function_reference/lead.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LEAD"}],"/reference/meta_database/function_reference/least.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LEAST"}],"/reference/meta_database/function_reference/length.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LENGTH"}],"/reference/meta_database/function_reference/ln.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LN"}],"/reference/meta_database/function_reference/log.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LOG"}],"/reference/meta_database/function_reference/lower.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LOWER"}],"/reference/meta_database/function_reference/lpad.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LPAD"}],"/reference/meta_database/function_reference/ltrim.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"LTRIM"}],"/reference/meta_database/function_reference/max.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"MAX"}],"/reference/meta_database/function_reference/median.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"MEDIAN"}],"/reference/meta_database/function_reference/min.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"MIN"}],"/reference/meta_database/function_reference/mod.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"MOD"}],"/reference/meta_database/function_reference/nth_value.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"NTH_VALUE"}],"/reference/meta_database/function_reference/nullif.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"NULLIF"}],"/reference/meta_database/function_reference/nvl.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"NVL"}],"/reference/meta_database/function_reference/nvl2.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"NVL2"}],"/reference/meta_database/function_reference/power.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"POWER"}],"/reference/meta_database/function_reference/rank.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"RANK"}],"/reference/meta_database/function_reference/regexp_instr.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"REGEXP_INSTR"}],"/reference/meta_database/function_reference/regexp_replace.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"REGEXP_REPLACE"}],"/reference/meta_database/function_reference/regexp_substr.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"REGEXP_SUBSTR"}],"/reference/meta_database/function_reference/remainder.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"REMAINDER"}],"/reference/meta_database/function_reference/replace.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"REPLACE"}],"/reference/meta_database/function_reference/round.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"ROUND"}],"/reference/meta_database/function_reference/row_number.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"ROW_NUMBER"}],"/reference/meta_database/function_reference/rpad.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"RPAD"}],"/reference/meta_database/function_reference/rtrim.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"RTRIM"}],"/reference/meta_database/function_reference/sign.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"SIGN"}],"/reference/meta_database/function_reference/sin.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"SIN"}],"/reference/meta_database/function_reference/sinh.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"SINH"}],"/reference/meta_database/function_reference/sqrt.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"SQRT"}],"/reference/meta_database/function_reference/substr.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"SUBSTR"}],"/reference/meta_database/function_reference/sum.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"SUM   "}],"/reference/meta_database/function_reference/tan.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"TAN"}],"/reference/meta_database/function_reference/tanh.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"TANH"}],"/reference/meta_database/function_reference/to_char.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"TO_CHAR"}],"/reference/meta_database/function_reference/translate.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"TRANSLATE"}],"/reference/meta_database/function_reference/trim.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"TRIM"}],"/reference/meta_database/function_reference/trunc.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"TRUNC"}],"/reference/meta_database/function_reference/upper.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"UPPER"}],"/reference/meta_database/function_reference/window_function_syntax_usage.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/function_reference/","title":"Function Reference"},{"title":"Window function syntax and usage"}],"/reference/meta_database/scripting_reference/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"title":"Scripting Reference"}],"/reference/meta_database/scripting_reference/begin_end.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"BEGIN ... END"}],"/reference/meta_database/scripting_reference/break.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"BREAK"}],"/reference/meta_database/scripting_reference/case.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"CASE"}],"/reference/meta_database/scripting_reference/continue.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"CONTINUE"}],"/reference/meta_database/scripting_reference/declare.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"DECLARE"}],"/reference/meta_database/scripting_reference/exception.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"EXCEPTION"}],"/reference/meta_database/scripting_reference/for.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"FOR"}],"/reference/meta_database/scripting_reference/if.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"IF"}],"/reference/meta_database/scripting_reference/let.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"LET"}],"/reference/meta_database/scripting_reference/null.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"NULL"}],"/reference/meta_database/scripting_reference/raise.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"RAISE"}],"/reference/meta_database/scripting_reference/return.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"RETURN"}],"/reference/meta_database/scripting_reference/while.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/scripting_reference/","title":"Scripting Reference"},{"title":"WHILE"}],"/reference/meta_database/information_schema/index.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"title":"Information Schema"}],"/reference/meta_database/information_schema/columns.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/information_schema/","title":"Information Schema"},{"title":"COLUMNS"}],"/reference/meta_database/information_schema/commits.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/information_schema/","title":"Information Schema"},{"title":"COMMITS"}],"/reference/meta_database/information_schema/deliveries.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/information_schema/","title":"Information Schema"},{"title":"DELIVERIES"}],"/reference/meta_database/information_schema/instance_labels.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/information_schema/","title":"Information Schema"},{"title":"INSTANCE_LABELS"}],"/reference/meta_database/information_schema/instance_metadata.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/information_schema/","title":"Information Schema"},{"title":"Instance Metadata"}],"/reference/meta_database/information_schema/instances.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/information_schema/","title":"Information Schema"},{"title":"INSTANCES"}],"/reference/meta_database/information_schema/pattern_variables.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/information_schema/","title":"Information Schema"},{"title":"PATTERN_VARIABLES"}],"/reference/meta_database/information_schema/tables.md":[{"link":"/reference/","title":"Reference"},{"link":"/reference/meta_database/","title":"Meta Database"},{"link":"/reference/meta_database/information_schema/","title":"Information Schema"},{"title":"TABLES"}],"/tutorials/index.md":[{"title":"Tutorials"}],"/tutorials/azure_synapse/index.md":[{"link":"/tutorials/","title":"Tutorials"},{"title":"Azure Synapse Analytics"}],"/tutorials/azure_synapse/1_create_pattern_in_mkw.md":[{"link":"/tutorials/","title":"Tutorials"},{"link":"/tutorials/azure_synapse/","title":"Azure Synapse Analytics"},{"title":"Part 1  Create a Pattern in MetaKraftwerk"}],"/tutorials/azure_synapse/2_create_instance_in_mkw.md":[{"link":"/tutorials/","title":"Tutorials"},{"link":"/tutorials/azure_synapse/","title":"Azure Synapse Analytics"},{"title":"Part 2  Create Instances of the Pattern in MKW"}],"/tutorials/azure_synapse/3_create_notebook_in_synapse.md":[{"link":"/tutorials/","title":"Tutorials"},{"link":"/tutorials/azure_synapse/","title":"Azure Synapse Analytics"},{"title":"Part 3  Synapse: Prepare and Create a Notebook"}],"/tutorials/azure_synapse/4_create_pipeline_in_synapse.md":[{"link":"/tutorials/","title":"Tutorials"},{"link":"/tutorials/azure_synapse/","title":"Azure Synapse Analytics"},{"title":"Part 4  Synapse: Create a Pipeline and Download support files"}],"/tutorials/azure_synapse/5_upload_develop_pattern_in_mkw.md":[{"link":"/tutorials/","title":"Tutorials"},{"link":"/tutorials/azure_synapse/","title":"Azure Synapse Analytics"},{"title":"Part 5  Upload & Develop Pattern in MKW"}],"/tutorials/azure_synapse/6_build_instance_and_deploy_to_synapse.md":[{"link":"/tutorials/","title":"Tutorials"},{"link":"/tutorials/azure_synapse/","title":"Azure Synapse Analytics"},{"title":"Part 6  Build the Instances and Deploy to Synapse"}],"/tutorials/azure_synapse/bonus_1_markdown_header.md":[{"link":"/tutorials/","title":"Tutorials"},{"link":"/tutorials/azure_synapse/","title":"Azure Synapse Analytics"},{"title":"Part 7 (optional) - Add a dynamic markdown header"}],"/tutorials/azure_synapse/bonus_2_master_pipleine.md":[{"link":"/tutorials/","title":"Tutorials"},{"link":"/tutorials/azure_synapse/","title":"Azure Synapse Analytics"},{"title":"Part 8 (optional) - Create a Master Pipeline in Synapse"}],"/tutorials/informatica_bigquery.md":[{"link":"/tutorials/","title":"Tutorials"},{"title":"Informatica + BigQuery"}],"https://www.metakraftwerk.de/en/request-whitepaper/index.md":[{"title":"Whitepapers"}]}},"headers":[],"relativePath":"guides/sql_guide/window_functions.md","filePath":"guides/sql_guide/window_functions.md","lastUpdated":1769682145000}'),h={name:"guides/sql_guide/window_functions.md"},k=i(`<h1 id="working-with-window-functions" tabindex="-1">Working with window functions <a class="header-anchor" href="#working-with-window-functions" aria-label="Permalink to &quot;Working with window functions&quot;"></a></h1><p>In this section we describe the conceptual structure and general usage of window functions.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;"></a></h2><p>Unlike other SQL functions, a window function calculates the values on a group or tuple of rows. Such a group is called a partition. Partitions are defined by specifying implicit or explicit &quot;window frames&quot;. A window frame is calculated relative to the current row and contains a fixed or variable set of rows. The function results are calculated per row within each partition. Each row within the window frame therefore becomes the current row.</p><p>The window functions calculate the values over the defined partition and return them for each row belonging to this partition.</p><p>The <code>OVER()</code> clause defines the components, that are necessary to accomplish this behavior:</p><ul><li>A <code>PARTITION BY</code> clause</li><li>An <code>ORDER BY</code> clause</li><li>A specification of the <em><strong>window frame</strong></em>.</li></ul><p>From query to query all of this components may be optional or contains multiple <code>OVER()</code> clauses.</p><p>A query with an empty <code>OVER()</code> clause can also be valid. In this case, the values are calculated across all rows (as if all rows belonged to the same partition) but, unlike aggregate functions, are not output as one row but per row.</p><h2 id="syntax" tabindex="-1">Syntax <a id="syntax"></a> <a class="header-anchor" href="#syntax" aria-label="Permalink to &quot;Syntax &lt;a id=&quot;syntax&quot;&gt;&lt;/a&gt;&quot;"></a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">function_name([function_arguments]) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ([PARTITION BY part_expr [, ...]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             [ORDER BY order_expr [ASC | DESC] [NULLS {FIRST | LAST}] [, ...]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             [{   {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                | {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PRECEDING</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                | {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                | {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                | {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                | {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                | {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PRECEDING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PRECEDING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                | {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PRECEDING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                | {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PRECEDING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                }])</span></span></code></pre></div><h3 id="arguments" tabindex="-1">Arguments <a class="header-anchor" href="#arguments" aria-label="Permalink to &quot;Arguments&quot;"></a></h3><div class="mkw_lv0_init_line"><p><em><strong>function_name</strong></em>: Name of an SQL Function.</p></div><div class="mkw_lv0_init_line"><p><em><strong>function_arguments</strong></em> <em>(optional)</em>: Function arguments.</p></div><div class="mkw_lv0_init_line"><p><em><strong>OVER()</strong></em>: This clause specifies that this function should be applied as a window function (and not as an aggregate function) and specifies the window frame over which rows the function should be applied.</p></div><div class="mkw_lv0_line"><p>An <code>OVER()</code> clause with empty parentheses uses all rows as one partition and an implicit default window frame.</p></div><div class="mkw_lv0_init_line"><p><em><strong>PARTITION BY part_expr</strong></em> <em>(optional)</em>: This clause specifies the <em><strong>part_expr</strong></em>, that used to group rows into partitions.</p></div><div class="mkw_lv0_line"><p>Values are calculated per partition if this clause is specified. If this clause is omitted, all rows in the query are considered as one partition.</p></div><div class="mkw_lv0_init_line"><p><em><strong>ORDER BY order_expr</strong></em> <em>(optional or required)</em>: This clause sorts rows within a partition before the function calculates the values. <code>ORDER BY</code> clause is required, if a window frame is specified explicitly or for some specific functions and optional in all other cases.</p></div><div class="mkw_lv0_line"><p><code>ORDER BY</code> within the <code>OVER()</code> clause is to be distinguished from the <code>ORDER BY</code> clause, which is used to sort the results of a query, although they have the same syntax.</p><p>More about data sorting for window functions and <code>ORDER BY</code> within an <code>OVER()</code> clause can be found below in the section <a href="#ordering_the_rows">ORDER BY clause</a>.</p></div><hr><div class="mkw_lv0_init_line"><p><u><em><strong>Window Frame definition options</strong></em></u>:</p><p>See <a href="#range_vs_row_based_window_frames">Range- vs. row-based window frames</a>, <a href="#range_based_window_frames_details">RANGE-based window frames</a>, <a href="#row_based_window_frames_details">ROW-based window frames</a> and <a href="#further_examples">Further examples</a> for more information and more examples.</p></div><div class="mkw_lv0_init_line"><p><em><strong>RANGE UNBOUNDED PRECEDING</strong></em> or <em><strong>ROWS UNBOUNDED PRECEDING</strong></em>: This keywords specifies a window frame that contains rows between the first row in the partition and the current row.</p></div><div class="mkw_lv0_init_line"><p><em><strong>RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING</strong></em> or <em><strong>ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING</strong></em> : This keywords specifies a window frame that contains rows between the current row the and last row in the partition.</p></div><div class="mkw_lv0_init_line"><p><em><strong>ROWS BETWEEN n {PRECEDING | FOLLOWING} AND n {PRECEDING | FOLLOWING}</strong></em> : This clause allows to define a <code>ROWS</code>-based window frame with the explicitly specified offset of size <em><strong>n</strong></em>.</p></div><p><em><strong>ROWS BETWEEN n {PRECEDING | FOLLOWING} AND n {PRECEDING | FOLLOWING}</strong></em> or <br><em><strong>ROWS BETWEEN UNBOUNDED PRECEDING AND n {PRECEDING | FOLLOWING}</strong></em> or <br><em><strong>ROWS BETWEEN n {PRECEDING | FOLLOWING} AND UNBOUNDED FOLLOWING</strong></em></p><div class="mkw_lv0_line"><p>This clauses allows defining a ROWS-based window frame with the explicitly specified offset of size <em><strong>n</strong></em> or use the <code>UNBOUNDED</code> keyword to define one of the boundaries as a dynamic frame boundary.</p></div><p><em><strong>RANGE BETWEEN n {PRECEDING | FOLLOWING} AND n {PRECEDING | FOLLOWING}</strong></em> or<br><em><strong>RANGE BETWEEN UNBOUNDED PRECEDING AND n {PRECEDING | FOLLOWING}</strong></em> or <br><em><strong>RANGE BETWEEN n {PRECEDING | FOLLOWING} AND UNBOUNDED FOLLOWING</strong></em></p><div class="mkw_lv0_line"><p>This clause allows to define a <code>RANGE</code>-based window frame with the explicitly specified offset of size <em><strong>n</strong></em> or use the <code>UNBOUNDED</code> keyword to define one of the boundaries as a dynamic frame boundary.</p></div><div class="mkw_lv0_line"><p>When specifying <code>RANGE BETWEEN</code> window frames with explicit offsets, only one <code>ORDER BY</code> expression is allowed.</p><p>Not all data types are supported by this type of window frame. See more about data types, limitations and other options for this type of window frames under <a href="#range_based_window_frames_details">RANGE-based window frames</a>.</p><p><em><strong>n</strong></em>: is an unsigned constant, positive numeric value including 0.</p><p>With <code>ORDER BY ord_expr ASC</code>, the syntax <code>...n FOLLOWING</code> means, that all rows of the partition of the current row with <em><strong>order_expr</strong></em> values, that are between <u><em><strong>x</strong></em></u> and <u><em><strong>x+n</strong></em></u> will be included in the window frame, where <em><strong>x</strong></em> is the value of <em><strong>ord_expr</strong></em> expression for current row. The syntax <code>...n PRECEDING</code> means in this case, that all rows of the partition of the current row with <em><strong>order_expr</strong></em> values, that are between <u><em><strong>x-n</strong></em></u> and <u><em><strong>x</strong></em></u> will be included in the window frame. See <a href="#range_between_examples">RANGE BETWEEN examples</a>.</p><p>With <code>ORDER BY DESC</code> both clauses behave in opposite ways.</p></div><p><a id="syntax_important_notes"></a></p><div class="warning custom-block"><p class="custom-block-title"><em><strong>Important Notes</strong></em></p><ul><li>Window frames are supported by all window functions. However, the syntax and supported types of window frames can vary from function to function.</li><li>If <u><i>no window frame</i></u> was specified explicitely and <u><i><code>ORDER BY</code> clause is specified</i></u>, default syntax for window frame specification is used. The default window frame syntax for functions <a href="./../../reference/meta_database/function_reference/count.html">COUNT</a>, <a href="./../../reference/meta_database/function_reference/min.html">MIN</a>, <a href="./../../reference/meta_database/function_reference/max.html">MAX</a>, <a href="./../../reference/meta_database/function_reference/sum.html">SUM</a> and <a href="./../../reference/meta_database/function_reference/avg.html">AVG</a> is <code>RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code>. See also example and notes for <a href="#supported_non_ranking_funktions">this example</a>.</li><li>If an empty <code>OVER()</code> is used, that is, no window frame is explicitly specified and no <code>ORDER BY</code> clause is specified, <code>RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING</code> is the default for the functions <a href="./../../reference/meta_database/function_reference/count.html">COUNT</a>, <a href="./../../reference/meta_database/function_reference/min.html">MIN</a>, <a href="./../../reference/meta_database/function_reference/max.html">MAX</a>, <a href="./../../reference/meta_database/function_reference/sum.html">SUM</a> and <a href="./../../reference/meta_database/function_reference/avg.html">AVG</a>. See also example and notes for <a href="#supported_non_ranking_funktions">this example</a>.</li><li>The offsets, specified as <code>0 PRECEDING</code> or <code>0 FOLLOWING</code> are equivalent to <code>CURRENT ROW</code>.</li><li>When you define an explicit window frame, the window functions require that the data in the window be in a known order. Therefore, the <code>ORDER BY</code> clause within the <code>OVER()</code> clause is mandatory for the window frame syntax, although this <code>ORDER BY</code> clause is generally optional.</li></ul></div><h2 id="examples-index-tables" tabindex="-1">Examples: Index &amp; Tables <a class="header-anchor" href="#examples-index-tables" aria-label="Permalink to &quot;Examples: Index &amp; Tables&quot;"></a></h2><p>Examples:</p><ul><li><a href="#range_unbounded_preceding_example">ROWS &amp; RANGE UNBOUNDED PRECEDING</a></li><li><a href="#between_current_row_and_unbounded_following">ROWS &amp; RANGE BETWEEN, Named Mixed Boundaries: cumulative totals</a></li><li><a href="#between_unbounded_preceding_and_unbounded_following">ROWS &amp; RANGE BETWEEN, Named Opened Boundaries, PARTITION BY: totals per partition</a></li><li><a href="#between_unbounded_preceding_and_current_row">ROWS &amp; RANGE BETWEEN, Named Mixed Boundaries, PARTITION BY: cumulative totals per partition</a></li><li><a href="#between_preceding_and_following_rows">ROWS BETWEEN, Mixed &amp; Explicit Boundaries, PARTITION BY: moving averages (sliding)</a></li><li><a href="#between_preceding_and_following_range">RANGE BETWEEN, Mixed &amp; Explicit Boundaries, PARTITION BY: averages, syntax errors</a></li><li><a href="#compr_range_and_rows_between_examples">RANGE &amp; ROWS BETWEEN Comparison</a></li></ul><ul><li><a href="#supported_non_ranking_funktions">Supported non-ranking window functions</a></li><li><a href="#supported_non_ranking_funktions">Default window frame definitions for queries with and without <code>ORDER BY</code> clause</a> <em>(see notes)</em></li><li><a href="#assymetric_boundaries">ROWS BETWEEN explicit frames without current row</a></li><li><a href="#using_group_by_with_window_functions"><code>GROUP BY</code>and window functions</a></li><li><a href="#handling_of_null_values_examples">Handling of <code>NULL</code> values</a></li></ul><p><a id="create_test_table"></a></p><details><summary><i><b>Please create this tables</b> if you want to try the examples yourself: Create <i>my_table</i> and <i>my_table2</i> tables (<b>please unfold</b>).</i></summary><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ord STRING,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp STRING,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  col1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INTEGER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INTEGER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  col2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INTEGER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INTEGER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  date_str STRING</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (ord, grp, col1, grp2, col2, id, date_str) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-06-30&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-07-31&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-08-31&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-09-30&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">35</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-10-31&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-11-30&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">45</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-12-31&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">53</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2024-01-31&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2024-02-29&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2024-03-31&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-------+------+------+------+----+-------------------------+</span></span>
<span class="line"><span>| ORD | GRP   | COL1 | GRP2 | COL2 | ID | DATE                    |</span></span>
<span class="line"><span>+-----+-------+------+------+------+----+-------------------------+</span></span>
<span class="line"><span>| a   | g1    | 10   | 1    | 10   | 1  | 2023-06-30 00:00:00.000 |</span></span>
<span class="line"><span>| b   | g1    | 20   | 1    | 20   | 2  | 2023-07-31 00:00:00.000 |</span></span>
<span class="line"><span>| c   | g1    | 20   | NULL | 25   | 3  | 2023-08-31 00:00:00.000 |</span></span>
<span class="line"><span>| a   | g2    | 30   | 2    | 30   | 4  | 2023-09-30 00:00:00.000 |</span></span>
<span class="line"><span>| b   | g2    | 30   | 2    | 35   | 5  | 2023-10-31 00:00:00.000 |</span></span>
<span class="line"><span>| c   | g2    | 40   | 2    | 40   | 6  | 2023-11-30 00:00:00.000 |</span></span>
<span class="line"><span>| a   | g3    | 50   | 3    | 45   | 7  | 2023-12-31 00:00:00.000 |</span></span>
<span class="line"><span>| b   | g3    | 50   | NULL | 53   | 8  | 2024-01-31 00:00:00.000 |</span></span>
<span class="line"><span>| c   | g3    | 60   | NULL | 60   | 9  | 2024-02-29 00:00:00.000 |</span></span>
<span class="line"><span>| d   | g3    | 50   | 3    | 55   | 10 | 2024-03-31 00:00:00.000 |</span></span>
<span class="line"><span>+-----+-------+------+------+------+----+-------------------------+</span></span></code></pre></div><p>And:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  product STRING, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  prod_cat STRING, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  sale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DECIMAL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  quarter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INTEGER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  quarter_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DECIMAL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Blue Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Red Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,		</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Yellow Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Blue Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Red Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,		</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Yellow Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Blue Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Red Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,		</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Yellow Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Blue Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Red Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,		</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Yellow Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Blue Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Grey Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Green Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Blue Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Grey Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">31</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Green Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Blue Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Grey Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Green Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Blue Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Grey Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Green Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-------------+----------+------+---------+-----------+</span></span>
<span class="line"><span>| PRODUCT     | PROD_CAT | SALE | QUARTER | QUARTER_2 |</span></span>
<span class="line"><span>+-------------+----------+------+---------+-----------+</span></span>
<span class="line"><span>| Blue Hat    | Hat      | 3.5  | 1       | 1.1       |</span></span>
<span class="line"><span>| Red Hat     | Hat      | 4    | 1       | 1.1       |</span></span>
<span class="line"><span>| Yellow Hat  | Hat      | 4.5  | 1       | 1.1       |</span></span>
<span class="line"><span>| Blue Hat    | Hat      | 2.8  | 2       | 1.2       |</span></span>
<span class="line"><span>| Red Hat     | Hat      | 3.2  | 2       | 1.2       |</span></span>
<span class="line"><span>| Yellow Hat  | Hat      | 1.5  | 2       | 1.2       |</span></span>
<span class="line"><span>| Blue Hat    | Hat      | 3.3  | 3       | 1.3       |</span></span>
<span class="line"><span>| Red Hat     | Hat      | 4.8  | 3       | 1.3       |</span></span>
<span class="line"><span>| Yellow Hat  | Hat      | 5.5  | 3       | 1.3       |</span></span>
<span class="line"><span>| Blue Hat    | Hat      | 3.5  | 4       | 1.4       |</span></span>
<span class="line"><span>| Red Hat     | Hat      | 4    | 4       | 1.4       |</span></span>
<span class="line"><span>| Yellow Hat  | Hat      | 4.6  | 4       | 1.4       |</span></span>
<span class="line"><span>| Blue Jeans  | Jeans    | 13.5 | 1       | 1.1       |</span></span>
<span class="line"><span>| Grey Jeans  | Jeans    | 22.6 | 1       | 1.1       |</span></span>
<span class="line"><span>| Green Jeans | Jeans    | 16.5 | 1       | 1.1       |</span></span>
<span class="line"><span>| Blue Jeans  | Jeans    | 12.8 | 2       | 1.2       |</span></span>
<span class="line"><span>| Grey Jeans  | Jeans    | 31.7 | 2       | 1.2       |</span></span>
<span class="line"><span>| Green Jeans | Jeans    | 10.3 | 2       | 1.2       |</span></span>
<span class="line"><span>| Blue Jeans  | Jeans    | 11.4 | 3       | 1.3       |</span></span>
<span class="line"><span>| Grey Jeans  | Jeans    | 23.9 | 3       | 1.3       |</span></span>
<span class="line"><span>| Green Jeans | Jeans    | 23.8 | 3       | 1.3       |</span></span>
<span class="line"><span>| Blue Jeans  | Jeans    | 19.1 | 4       | 1.4       |</span></span>
<span class="line"><span>| Grey Jeans  | Jeans    | 17.3 | 4       | 1.4       |</span></span>
<span class="line"><span>| Green Jeans | Jeans    | 17.4 | 4       | 1.4       |</span></span>
<span class="line"><span>+-------------+----------+------+---------+-----------+</span></span></code></pre></div></details><h2 id="window-vs-aggregate-functions" tabindex="-1">Window vs. aggregate functions <a class="header-anchor" href="#window-vs-aggregate-functions" aria-label="Permalink to &quot;Window vs. aggregate functions&quot;"></a></h2><p>Some aggregate functions have window function implementations of the same name (see <a href="./../../reference/meta_database/function_reference/count.html">COUNT</a>, <a href="./../../reference/meta_database/function_reference/min.html">MIN</a>, <a href="./../../reference/meta_database/function_reference/max.html">MAX</a>, <a href="./../../reference/meta_database/function_reference/sum.html">SUM</a> and <a href="./../../reference/meta_database/function_reference/avg.html">AVG</a>).</p><p>The differences lie in the scope of rows used for the calculation and in the way the results are output.</p><table><tr><td></td><td>AGGREGATE FUNCTION</td><td>WINDOW FUNCTION</td></tr><tr><td>Input Data</td><td>All rows</td><td>Rows of the partition, defined by OVER clause</td></tr><tr><td>Output Data</td><td>One row</td><td>Per row of the corresponding partition </td></tr></table><p>Compare the output of <a href="./../../reference/meta_database/function_reference/avg.html">AVG</a> function as aggregation function and window function:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-kYxXz" id="tab-oPrXDt_" checked="checked"><label for="tab-oPrXDt_">Function</label><input type="radio" name="group-kYxXz" id="tab-BehUJJY"><label for="tab-BehUJJY">Results</label></div><div class="blocks"><div class="language-sql vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+---------- +</span></span>
<span class="line"><span>| AVG(COL1) |</span></span>
<span class="line"><span>+-----------+</span></span>
<span class="line"><span>| 36        |</span></span>
<span class="line"><span>+-----------+</span></span>
<span class="line"><span></span></span>
<span class="line"><span>+------------------+</span></span>
<span class="line"><span>| AVG(COL1) OVER() |</span></span>
<span class="line"><span>+------------------+</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>| 36               |</span></span>
<span class="line"><span>+------------------+</span></span></code></pre></div></div></div><p>In this example, we used the <a href="./../../reference/meta_database/function_reference/avg.html">AVG</a> window function with an empty <code>OVER()</code> clause, which resulted in the same average value being calculated because all 10 rows were analyzed as one partition, but it was output per row and not in one row as in the aggregation variant.</p><p>In following example we use the same table, but analyse the partitions, based on column <em><strong>grp</strong></em>:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-Qc2wk" id="tab-QX_6_YZ" checked="checked"><label for="tab-QX_6_YZ">Function</label><input type="radio" name="group-Qc2wk" id="tab-teXxBZd"><label for="tab-teXxBZd">Results</label></div><div class="blocks"><div class="language-sql vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- aggregate</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, col1, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- window</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+------------+</span></span>
<span class="line"><span>| GRP | AVG(COL1)  |</span></span>
<span class="line"><span>+-----+------------+</span></span>
<span class="line"><span>| g1  | 16.666667  |</span></span>
<span class="line"><span>| g2  | 33.333333  |</span></span>
<span class="line"><span>| g3  | 52.500000  |</span></span>
<span class="line"><span>+-----+------------+</span></span>
<span class="line"><span></span></span>
<span class="line"><span>+-----+------+----------------------------------+</span></span>
<span class="line"><span>| GRP | COL1 | AVG(COL1) OVER(PARTITION BY GRP) |</span></span>
<span class="line"><span>+-----+------+----------------------------------+</span></span>
<span class="line"><span>| g1  | 10   | 16.666                           |</span></span>
<span class="line"><span>| g1  | 20   | 16.666                           |</span></span>
<span class="line"><span>| g1  | 20   | 16.666                           |</span></span>
<span class="line"><span>| g2  | 30   | 33.333                           |</span></span>
<span class="line"><span>| g2  | 30   | 33.333                           |</span></span>
<span class="line"><span>| g2  | 40   | 33.333                           |</span></span>
<span class="line"><span>| g3  | 50   | 52.500                           |</span></span>
<span class="line"><span>| g3  | 50   | 52.500                           |</span></span>
<span class="line"><span>| g3  | 60   | 52.500                           |</span></span>
<span class="line"><span>| g3  | 50   | 52.500                           |</span></span>
<span class="line"><span>+-----+------+----------------------------------+</span></span></code></pre></div></div></div><p>The calculation is restarted when the value of the column defining the partition changes.</p><p>The functionality of window functions becomes even clearer when using the explicit window frame definition.</p><p>This example uses an explicit window definition to calculate the values per row as an average of the previous row, the current row, and a following row per <em><strong>grp</strong></em> partition:</p><p><a id="mooving_avg_example"></a></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, col1, ord,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                        ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                        ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MA</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+------+-----+--------+</span></span>
<span class="line"><span>| GRP | COL1 | ORD | MA     |</span></span>
<span class="line"><span>+-----+------+-----+--------+</span></span>
<span class="line"><span>| g1  | 10   | a   | 15.000 |</span></span>
<span class="line"><span>| g1  | 20   | b   | 16.666 |</span></span>
<span class="line"><span>| g1  | 20   | c   | 20.000 |</span></span>
<span class="line"><span>| g2  | 30   | a   | 30.000 |</span></span>
<span class="line"><span>| g2  | 30   | b   | 33.333 |</span></span>
<span class="line"><span>| g2  | 40   | c   | 35.000 |</span></span>
<span class="line"><span>| g3  | 50   | a   | 50.000 |</span></span>
<span class="line"><span>| g3  | 50   | b   | 53.333 |</span></span>
<span class="line"><span>| g3  | 60   | c   | 53.333 |</span></span>
<span class="line"><span>| g3  | 50   | d   | 55.000 |</span></span>
<span class="line"><span>+-----+------+-----+--------+</span></span></code></pre></div><p>The value for row <em><strong>GRP=&#39;g1&#39; and ORD=&#39;a&#39;</strong></em> is calculated as an average of values <em><strong>10</strong></em> and <em><strong>20</strong></em> because it is the first row in the partition (you can also see it in rows <em><strong>GRP=&#39;g2&#39; and ORD=&#39;a&#39;</strong></em> and <em><strong>GRP=&#39;g3&#39; and ORD=&#39;a&#39;</strong></em>).</p><p>The value for row <em><strong>GRP=&#39;g1&#39; and ORD=&#39;c&#39;</strong></em> is calculated as an average of values <em><strong>20</strong></em> and <em><strong>20</strong></em> because it is the last row in the partition (same as for last values of other <em><strong>grp</strong></em> partitions).</p><p>Other values were calculated as an average of a previous, current and following row.</p><p>The <code>ORDER BY</code> clause within the <code>OVER()</code> clause influences the sorting of the window data within the partition, whereas the final order by clause only influences the output sorting.</p><p>The output of the window function therefore depends not only on the value of the individual line, but also on the values of the other lines that qualify for the defined window frame.</p><h2 id="order-by-clause" tabindex="-1">ORDER BY clause <a id="ordering_the_rows"></a> <a class="header-anchor" href="#order-by-clause" aria-label="Permalink to &quot;ORDER BY clause &lt;a id=&quot;ordering_the_rows&quot;&gt;&lt;/a&gt;&quot;"></a></h2><p>The <code>ORDER BY</code> clause of the <code>OVER()</code> clause ensures that the calculation of the result is based on the sorted data.</p><p>The <code>ORDER BY</code> clause is required when window functions compute rolling operations on the subsets of rows in each partition and apply them to data with explicit window borders (e.g. calculating <a href="./../../reference/meta_database/function_reference/sum.html#example_3">running totals</a>, <a href="#mooving_avg_example">moving averages</a> etc.). For window functions of this kind, the set of &quot;previous&quot; and &quot;following&quot; rows must be deterministic and thus the <code>ORDER BY</code> clause is necessary.</p><p>The <code>ORDER BY</code> clause within the <code>OVER()</code> clause affects the sorting of the window data used in the calculation, but not the output of the query.</p><p>The output of the query can be sorted using the regular <code>ORDER BY</code> clause.</p><p>Compare this example with the <a href="#mooving_avg_example">example above</a>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, col1, ord,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                        ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                        ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MA</span></span>
<span class="line highlighted warning"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, col1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                 </span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+------+-----+--------+</span></span>
<span class="line"><span>| GRP | COL1 | ORD | MA     |</span></span>
<span class="line"><span>+-----+------+-----+--------+</span></span>
<span class="line"><span>| g1  | 20   | c   | 20.000 |</span></span>
<span class="line"><span>| g1  | 20   | b   | 16.666 |</span></span>
<span class="line"><span>| g1  | 10   | a   | 15.000 |</span></span>
<span class="line"><span>| g2  | 40   | c   | 35.000 |</span></span>
<span class="line"><span>| g2  | 30   | b   | 33.333 |</span></span>
<span class="line"><span>| g2  | 30   | a   | 30.000 |</span></span>
<span class="line"><span>| g3  | 60   | c   | 53.333 |</span></span>
<span class="line"><span>| g3  | 50   | d   | 55.000 |</span></span>
<span class="line"><span>| g3  | 50   | b   | 53.333 |</span></span>
<span class="line"><span>| g3  | 50   | a   | 50.000 |</span></span>
<span class="line"><span>+-----+------+-----+--------+</span></span></code></pre></div><p>The results for each <em><strong>grp x ord</strong></em> pair did not change because the window definition remained the same. Only the output sorting <code>ORDER BY grp, ord</code> was changed to <code>ORDER BY grp, col1 DESC</code>, which resulted in a different sorting of the output.</p><p>The syntax of the <code>ORDER BY</code> clause within an <code>OVER()</code> clause is similar to the syntax of the regular <code>ORDER BY</code> clause with regard to the keywords <code>ASC</code> and <code>DESC</code> and the handling of <code>NULL</code> values.</p>`,68),d=e("code",null,"ORDER BY",-1),c=e("a",{href:"#rows_based_window_frames_details"},"ROWS-based window frames",-1),E=e("a",{href:"#range_based_window_frames_details"},"RANGE-based window frames",-1),o=e("a",{href:"#handling_of_null_values_examples"},"Example: Handling of NULL Values",-1),g=i(`<p>In summary, the following must be considered when deciding whether to use an <code>ORDER BY</code> clause in an <code>OVER()</code> clause:</p><ul><li>Both the <code>ORDER BY</code> clause and the <code>PARTITION BY</code> clause within an <code>OVER()</code> clause are optional and are used independently.</li><li>Some functions require the presence of an <code>ORDER BY</code> clause in an <code>OVER()</code> clause.</li><li>For some functions, an <code>ORDER BY</code> clause within an <code>OVER()</code> clause is optional.</li><li>Some functions do not allow an <code>ORDER BY</code> clause within an <code>OVER()</code> clause.</li><li>An <code>ORDER BY</code> clause within an <code>OVER()</code> clause is evaluated by some functions as an implicit window frame definition.</li></ul><div class="warning custom-block"><p class="custom-block-title">Caution</p><p>Generally speaking, SQL is an explicit language, with few implied clauses. However, for some window functions, an ORDER BY clause implies a window frame. For details, see <a href="./../../reference/meta_database/function_reference/window_function_syntax_usage.html#usage-notes-for-window-frames">Usage notes for window frames</a>.</p><p>Because behavior that is implied rather than explicit can lead to results that are difficult to understand, Snowflake recommends declaring window frames explicitly.</p></div><h1 id="types-of-window-frames" tabindex="-1">Types of window frames <a class="header-anchor" href="#types-of-window-frames" aria-label="Permalink to &quot;Types of window frames&quot;"></a></h1><p>Depending on the clauses used and the purpose of the calculation, one can distinguish between different types of window frames. One speaks of</p><ul><li>implicit &amp; explicit window frames,</li><li>ROW-based &amp; RANGE-based window frames,</li><li>cummulative &amp; sliding window frames.</li></ul><h2 id="implicit-explicit-window-frames" tabindex="-1">Implicit &amp; Explicit window frames <a class="header-anchor" href="#implicit-explicit-window-frames" aria-label="Permalink to &quot;Implicit &amp; Explicit window frames&quot;"></a></h2><p><em><strong>Explicit window frame</strong></em> definition is described in the <a href="#syntax">Syntax</a>. This type of definition includes ways to use an offset of defined size or open boundaries to limit window frames for the rows to which the function is to be applied.</p><p><em><strong>Implicit window frames</strong></em> are defined by the system if the <code>OVER()</code> clause does not contain an explicit window frame definition. For more about default definitions of implicit window frames, see <a href="#syntax">Syntax</a> and the <a href="#syntax_important_notes">Important Notes</a>.</p><h2 id="range-rows-based-window-frames" tabindex="-1">RANGE- &amp; ROWS-based window frames <a id="range_vs_row_based_window_frames"></a> <a class="header-anchor" href="#range-rows-based-window-frames" aria-label="Permalink to &quot;RANGE- &amp; ROWS-based window frames &lt;a id=&quot;range_vs_row_based_window_frames&quot;&gt;&lt;/a&gt;&quot;"></a></h2><p>Both <code>ROWS</code> based window frame specifications and <code>RANGE</code> based specifications specify start and end points that specify the group of rows to which the function is applied. These boundaries can be specified as exact offset values (<em><strong>explicit boundaries</strong></em> as number of rows <em><strong>n</strong></em>) or named boundaries (<em><strong>implicit boundaries</strong></em>).</p><p>Explicit offset values are defined with numbers or intervals and keywords <code>PRECEDING</code> or <code>FOLLOWING</code>.</p><p>When defining the named start and end points, you can use the following keywords:</p><ul><li><code>CURRENT ROW</code></li><li><code>UNBOUNDED PRECEDING</code>: from the beginning of the partition</li><li><code>UNBOUNDED FOLLOWING</code>: to the end of the partition.</li></ul><h2 id="rows-based-window-frames" tabindex="-1"> ROWS-based window frames <a id="rows_based_window_frames_details"></a> <a class="header-anchor" href="#rows-based-window-frames" aria-label="Permalink to &quot;&amp;#9900; ROWS-based window frames &lt;a id=&quot;rows_based_window_frames_details&quot;&gt;&lt;/a&gt;&quot;"></a></h2><p>With the <code>ROWS</code> based window frame definition, the frame is calculated as exact count of rows, relative to the current row and includes rows that physically fit into the frame defined by the specified offset. The physical order of the rows in the query has an influence and can be additionally specified using the <code>ORDER BY</code> clause.</p><p>Boundaries of the window frame and the current row are always included. This applies to both explicitly specified window frames and implicitly specified ones. A window frame, for example, that is delimited as <code>ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING</code> contains the current row and all physically subsequent rows up to the end of the partition. A specification of <code>ROWS BETWEEN CURRENT ROW AND 14 FOLLOWING</code> means that 14 following rows, counting from the current row, including the current row, are included in the window frame.</p><p>If the specified number of preceding or following rows exceeds the boundaries of the partition, the exceeding values are treated as <code>NULL</code>.</p><h2 id="range-based-window-frames" tabindex="-1"> RANGE-based window frames <a id="range_based_window_frames_details"></a> <a class="header-anchor" href="#range-based-window-frames" aria-label="Permalink to &quot;&amp;#9900; RANGE-based window frames &lt;a id=&quot;range_based_window_frames_details&quot;&gt;&lt;/a&gt;&quot;"></a></h2><p>A <code>RANGE</code>-based window frame in is a method of defining a <em>dynamic</em> set of rows used for calculations in a window function. Unlike <code>ROWS</code>, which refers to a fixed number of rows, <code>RANGE</code> is based on the <u>values</u> in a specific column and considers all rows within a specific <u>range of values</u>.</p><p>The column values used in the <code>ORDER BY</code> clause affect not only the sorting of the rows, but also the number of rows in the window frame defined as <code>RANGE</code> based window frame.</p><p>The process can be illustrated as follows:</p><ul><li>The data is sorted using the <code>ORDER BY</code> clause within the <code>OVER()</code> clause</li><li>Then the rows are iterated over: <ol><li>The <u>current row</u> is determined</li><li>The value of the <code>PARTITION BY</code> expression <em><strong>part_expr</strong></em> of the <u>current row</u> is determined</li><li>The value of the <code>ORDER BY</code> expression <em><strong>order_expr</strong></em> of the <u>current row</u> is determined</li><li>All rows are found whose <code>ORDER BY</code> expression <em><strong>order_expr</strong></em> has values that are within the value range of the specified window frame boundaries.</li><li>For these rows, it is checked whether the value of the <code>PARTITION BY</code> expression <em><strong>part_expr</strong></em> corresponds to the value of the <code>PARTITION BY</code> expression <em><strong>part_expr</strong></em> of the <u>current row</u>.</li><li>The window frame includes the rows for which 4. and 5. apply, i.e. rows whose <em><strong>order_expr</strong></em> value lies within the window frame boundaries and which belong to the partition (including the <u>current row</u>).</li><li>The value is calculated and output.</li><li>The process is repeated from point 1. for the next row.</li></ol></li></ul><p>For example, with <code>ORDER BY my_col ASC RANGE BETWEEN 2 PRECEDING AND CURRENT ROW</code> the window frame contains</p><ul><li>all rows that have the same value in column <em><strong>my_col</strong></em> as the <u>current row</u> and belong to the same partition (including the <u>current row</u>)</li><li>all rows, whose <em><strong>my_col</strong></em> value is between the value of the current row <em><strong>x</strong></em> and the value <em><strong>x - 2</strong></em> and belong to the same partition.</li></ul><p>The order chosen in the <code>ORDER BY</code> clause plays in this example the following role: If the order <code>DESC</code> is chosen, rows with values in the range from <em><strong>x</strong></em> to <em><strong>x + 2</strong></em> are included in the window frame. If the order <code>ASC</code> is chosen, rows with values in the range from <em><strong>x - 2</strong></em> to <em><strong>x</strong></em> are included in the window frame.</p><p>The offset value is specified as a number.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Currently only numeric offsets are supported. Intervals are not yet supported.</p></div><h3 id="range-between-window-frames-limitations" tabindex="-1">RANGE BETWEEN window frames limitations <a class="header-anchor" href="#range-between-window-frames-limitations" aria-label="Permalink to &quot;RANGE BETWEEN window frames limitations&quot;"></a></h3><ul><li><code>RANGE BETWEEN</code> window frames with explicit offsets must have only one <code>ORDER BY</code> expression.</li><li>Data types supported for <code>ORDER BY</code> expression of window frame with explicit offsets: <ul><li><code>INTEGER</code></li><li><code>DECIMAL</code>.</li></ul></li></ul><ul><li><code>RANGE BETWEEN</code> window frames with explicit offsets require <em><strong>n</strong></em> as a positive numeric constant value including <em><strong>0</strong></em> if order_expr is of data type <code>INTEGER</code> or <code>FLOAT</code>. See <a href="#syntax">Syntax</a>.</li><li><code>RANGE BETWEEN</code> window frames with explicit offsets are supported by the following functions: <a href="./../../reference/meta_database/function_reference/count.html">COUNT</a>, <a href="./../../reference/meta_database/function_reference/min.html">MIN</a>, <a href="./../../reference/meta_database/function_reference/max.html">MAX</a>, <a href="./../../reference/meta_database/function_reference/sum.html">SUM</a> and <a href="./../../reference/meta_database/function_reference/avg.html">AVG</a>.</li><li><code>DISTINCT</code> is not supported for these functions when used in conjunction with <code>RANGE BETWEEN</code> window frames with explicit offsets.</li><li>The <code>COUNT</code> function can only be used with one argument when used in conjunction with <code>RANGE BETWEEN</code> window frames with explicit offsets.</li><li>Wildcard queries can not be used with <code>COUNT</code> when used in conjunction with <code>RANGE BETWEEN</code> window frames with explicit offsets.</li><li>The specification of the frame start and frame end points must be consistent. If this is not the case, i.e. if the frame start is after the frame end or the specification is reversed, an error is returned.</li></ul><div class="info custom-block"><p class="custom-block-title">Examples</p><p>Valid definitions: <br><code>...ORDER BY day_of_month ASC RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING...</code><br><code>...ORDER BY day_of_month ASC RANGE BETWEEN 1 FOLLOWING AND 2 FOLLOWING...</code><br><code>...ORDER BY day_of_month ASC RANGE BETWEEN 2 PRECEDING AND 1 PRECEDING...</code><br></p><p>Invalid definitions: <br><code>...ORDER BY day_of_month ASC RANGE BETWEEN 1 FOLLOWING AND 1 PRECEDING...</code><br><code>...ORDER BY day_of_month ASC RANGE BETWEEN 2 FOLLOWING AND 1 FOLLOWING...</code><br><code>...ORDER BY day_of_month ASC RANGE BETWEEN 1 PRECEDING AND 2 PRECEDING...</code><br></p></div><ul><li>If <code>ORDER BY</code> in <code>OVER()</code> contains <code>NULL</code> values, the following must be considered when using the window frame specification <code>RANGE BETWEEN</code>: <ul><li>By specifying <code>ORDER BY order_exmp NULLS FIRST</code> together with <code>UNBOUNDED PRECEDING</code>, rows with <code>NULL</code> values in the column <em><strong>order_exp</strong></em> are included in the frame. See <a href="#syntax">Syntax</a>.</li><li>By specifying <code>ORDER BY order_exmp NULLS LAST</code> together with <code>UNBOUNDED FOLLOWING</code>, rows with <code>NULL</code> values in the column <em><strong>order_exp</strong></em> are included in the frame. See <a href="#syntax">Syntax</a>.</li><li>If the value of column <em><strong>order_exp</strong></em> of the <code>ORDER BY</code> clause in the <code>OVER()</code> clause of the current row is <code>NULL</code>, rows with the value <code>NULL</code> are included in the frame boundary of the window frame with an explicit offset. Otherwise they are excluded.</li></ul></li></ul><p>See <a href="#compr_range_and_rows_between_examples">RANGE BETWEEN examples</a> examples, that illustrates the differences in behavior of <code>ROWS</code> and <code>RANGE</code> based window frame definitions.</p><h2 id="cumulative-sliding-window-frames" tabindex="-1">Cumulative &amp; Sliding window frames <a class="header-anchor" href="#cumulative-sliding-window-frames" aria-label="Permalink to &quot;Cumulative &amp; Sliding window frames&quot;"></a></h2><p>Window frames help you perform various kinds of analytical tasks, including cumulative and sliding (or &quot;moving&quot;) calculations.</p><p>Different window frame definitions are suitable for different calculation tasks.</p><p>The window frame definition also allows a mix of named frame boundaries and explicit offsets.</p><h2 id="cumulative-window-frames" tabindex="-1"> Cumulative window frames <a class="header-anchor" href="#cumulative-window-frames" aria-label="Permalink to &quot;&amp;#9900; Cumulative window frames&quot;"></a></h2><p>For example, to calculate the cumulative sum of previous rows up to the current row, the following query is enough:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id, col1, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cum_total </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+----+------+-----------+</span></span>
<span class="line"><span>| ID | COL1 | CUM_TOTAL |</span></span>
<span class="line"><span>+----+------+-----------+</span></span>
<span class="line"><span>| 1  | 10   | 10        |</span></span>
<span class="line"><span>| 2  | 20   | 30        |</span></span>
<span class="line"><span>| 3  | 20   | 50        |</span></span>
<span class="line"><span>| 4  | 30   | 80        |</span></span>
<span class="line"><span>| 5  | 30   | 110       |</span></span>
<span class="line"><span>| 6  | 40   | 150       |</span></span>
<span class="line"><span>| 7  | 50   | 200       |</span></span>
<span class="line"><span>| 8  | 50   | 250       |</span></span>
<span class="line"><span>| 9  | 60   | 310       |</span></span>
<span class="line"><span>| 10 | 50   | 360       |</span></span>
<span class="line"><span>+----+------+-----------+</span></span></code></pre></div><h2 id="sliding-window-frames" tabindex="-1"> Sliding window frames <a class="header-anchor" href="#sliding-window-frames" aria-label="Permalink to &quot;&amp;#9900; Sliding window frames&quot;"></a></h2><p>A sliding window frame is a frame of constant width that moves through the rows of a partition, covering a different section each time. The number of rows in the frame remains the same except at the beginning or end of a partition, where it may cover fewer rows.</p><p>This window frame type allows you to calculate moving averages based on a fixed-size interval, such as time periods. The average is &quot;moving&quot; because the actual values in the interval change with each &quot;movement&quot; across the underlying dimension, even though the size of the interval remains constant.</p><p>To calculate moving averages of adjacent values, you can &quot;slide&quot; the calculation across the rows:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id, col1, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+----+------+--------+</span></span>
<span class="line"><span>| ID | COL1 | MA     |</span></span>
<span class="line"><span>+----+------+--------+</span></span>
<span class="line"><span>| 1  | 10   | 15.000 |</span></span>
<span class="line"><span>| 2  | 20   | 16.666 |</span></span>
<span class="line"><span>| 3  | 20   | 23.333 |</span></span>
<span class="line"><span>| 4  | 30   | 26.666 |</span></span>
<span class="line"><span>| 5  | 30   | 33.333 |</span></span>
<span class="line"><span>| 6  | 40   | 40.000 |</span></span>
<span class="line"><span>| 7  | 50   | 46.666 |</span></span>
<span class="line"><span>| 8  | 50   | 53.333 |</span></span>
<span class="line"><span>| 9  | 60   | 53.333 |</span></span>
<span class="line"><span>| 10 | 50   | 55.000 |</span></span>
<span class="line"><span>+----+------+--------+</span></span></code></pre></div><p>Each value of the <strong>MA</strong> column in this example is an average of 3 values:</p><ul><li>Value of the <em><strong>col1</strong></em> column</li><li><em><strong>col1</strong></em> value of the previous row</li><li><em><strong>col1</strong></em> value of the following row.</li></ul><p>Another example uses a <code>RANGE</code>-based and <code>ROWS</code>-based window frame definition. Additionaly we use a mix of named frame boundaries and explicit offsets. In this example, we calculate an average of the <em><strong>col1</strong></em> value of the current row and the same value of the following two rows:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id, col1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_1,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_2 </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+----+------+--------+--------+</span></span>
<span class="line"><span>| ID | COL1 | MA_1   | MA_2   |</span></span>
<span class="line"><span>+----+------+--------+--------+</span></span>
<span class="line"><span>| 1  | 10   | 16.666 | 16.666 |</span></span>
<span class="line"><span>| 2  | 20   | 23.333 | 23.333 |</span></span>
<span class="line"><span>| 3  | 20   | 26.666 | 26.666 |</span></span>
<span class="line"><span>| 4  | 30   | 33.333 | 33.333 |</span></span>
<span class="line"><span>| 5  | 30   | 40.000 | 40.000 |</span></span>
<span class="line"><span>| 6  | 40   | 46.666 | 46.666 |</span></span>
<span class="line"><span>| 7  | 50   | 53.333 | 53.333 |</span></span>
<span class="line"><span>| 8  | 50   | 53.333 | 53.333 |</span></span>
<span class="line"><span>| 9  | 60   | 55.000 | 55.000 |</span></span>
<span class="line"><span>| 10 | 50   | 50.000 | 50.000 |</span></span>
<span class="line"><span>+----+------+--------+--------+</span></span></code></pre></div><p>Please note that in this case, the results in columns <em><strong>ma_1</strong></em> and <em><strong>ma_2</strong></em> are the same even though we used different window frame definitions. This is very often not the case.</p><p>In this example this is due to the underlying data structure that only contains unique values for the <em><strong>id</strong></em> column and that is used in the <code>ORDER BY</code> clause within the <code>OVER()</code> clause. For more information on the differences between <code>RANGE</code> and <code>ROWS</code>-based window frames, see more examples below and <a href="#range_vs_row_based_window_frames">RANGE and ROWS-based window frames</a>.</p><h2 id="further-examples" tabindex="-1">Further Examples <a id="further_examples"></a> <a class="header-anchor" href="#further-examples" aria-label="Permalink to &quot;Further Examples &lt;a id=&quot;further_examples&quot;&gt;&lt;/a&gt;&quot;"></a></h2><p><em>Please <a href="#create_test_table">create this tables</a> if You want to try the examples yourself.</em></p><h3 id="example-unbounded-preceding" tabindex="-1">Example: UNBOUNDED PRECEDING <a id="range_unbounded_preceding_example"></a> <a class="header-anchor" href="#example-unbounded-preceding" aria-label="Permalink to &quot;Example: UNBOUNDED PRECEDING &lt;a id=&quot;range_unbounded_preceding_example&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>Calculate the cumulative totals across all rows in ascending order:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp, ord, col1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_2,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span>
<span class="line"><span>| GRP | ORD | COL1 | SUM_1 | SUM_2 | SUM_3 |</span></span>
<span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span>
<span class="line"><span>| g1  | a   | 10   | 10    | 10    | 10    |</span></span>
<span class="line"><span>| g1  | b   | 20   | 30    | 30    | 30    |</span></span>
<span class="line"><span>| g1  | c   | 20   | 50    | 50    | 50    |</span></span>
<span class="line"><span>| g2  | a   | 30   | 80    | 80    | 80    |</span></span>
<span class="line"><span>| g2  | b   | 30   | 110   | 110   | 110   |</span></span>
<span class="line"><span>| g2  | c   | 40   | 150   | 150   | 150   |</span></span>
<span class="line"><span>| g3  | a   | 50   | 200   | 200   | 200   |</span></span>
<span class="line"><span>| g3  | b   | 50   | 250   | 250   | 250   |</span></span>
<span class="line"><span>| g3  | c   | 60   | 310   | 310   | 310   |</span></span>
<span class="line"><span>| g3  | d   | 50   | 360   | 360   | 360   |</span></span>
<span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span></code></pre></div><p><a id="range_between_examples"></a></p><h3 id="example-between-i-named-boundaries" tabindex="-1">Example: BETWEEN I Named Boundaries <a id="between_current_row_and_unbounded_following"></a> <a class="header-anchor" href="#example-between-i-named-boundaries" aria-label="Permalink to &quot;Example: BETWEEN I Named Boundaries &lt;a id=&quot;between_current_row_and_unbounded_following&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>Calculate the cumulative totals across all rows in descending order:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp, ord, col1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_2,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span>
<span class="line"><span>| GRP | ORD | COL1 | SUM_1 | SUM_2 | SUM_3 |</span></span>
<span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span>
<span class="line"><span>| g1  | a   | 10   | 360   | 360   | 10    |</span></span>
<span class="line"><span>| g1  | b   | 20   | 350   | 350   | 30    |</span></span>
<span class="line"><span>| g1  | c   | 20   | 330   | 330   | 50    |</span></span>
<span class="line"><span>| g2  | a   | 30   | 310   | 310   | 80    |</span></span>
<span class="line"><span>| g2  | b   | 30   | 280   | 280   | 110   |</span></span>
<span class="line"><span>| g2  | c   | 40   | 250   | 250   | 150   |</span></span>
<span class="line"><span>| g3  | a   | 50   | 210   | 210   | 200   |</span></span>
<span class="line"><span>| g3  | b   | 50   | 160   | 160   | 250   |</span></span>
<span class="line"><span>| g3  | c   | 60   | 110   | 110   | 310   |</span></span>
<span class="line"><span>| g3  | d   | 50   | 50    | 50    | 360   |</span></span>
<span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span></code></pre></div><h3 id="example-between-ii-named-boundaries" tabindex="-1">Example: BETWEEN II Named Boundaries <a id="between_unbounded_preceding_and_unbounded_following"></a> <a class="header-anchor" href="#example-between-ii-named-boundaries" aria-label="Permalink to &quot;Example: BETWEEN II Named Boundaries &lt;a id=&quot;between_unbounded_preceding_and_unbounded_following&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>Calculate totals per partition:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp, ord, col1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_2, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span>
<span class="line"><span>| GRP | ORD | COL1 | SUM_1 | SUM_2 | SUM_3 |</span></span>
<span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span>
<span class="line"><span>| g1  | a   | 10   | 360   | 50    | 50    |</span></span>
<span class="line"><span>| g1  | b   | 20   | 360   | 50    | 50    |</span></span>
<span class="line"><span>| g1  | c   | 20   | 360   | 50    | 50    |</span></span>
<span class="line"><span>| g2  | a   | 30   | 360   | 100   | 100   |</span></span>
<span class="line"><span>| g2  | b   | 30   | 360   | 100   | 100   |</span></span>
<span class="line"><span>| g2  | c   | 40   | 360   | 100   | 100   |</span></span>
<span class="line"><span>| g3  | a   | 50   | 360   | 210   | 210   |</span></span>
<span class="line"><span>| g3  | b   | 50   | 360   | 210   | 210   |</span></span>
<span class="line"><span>| g3  | c   | 60   | 360   | 210   | 210   |</span></span>
<span class="line"><span>| g3  | d   | 50   | 360   | 210   | 210   |</span></span>
<span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span></code></pre></div><h3 id="example-between-iii-named-boundaries" tabindex="-1">Example: BETWEEN III Named Boundaries <a id="between_unbounded_preceding_and_current_row"></a> <a class="header-anchor" href="#example-between-iii-named-boundaries" aria-label="Permalink to &quot;Example: BETWEEN III Named Boundaries  &lt;a id=&quot;between_unbounded_preceding_and_current_row&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>Another example of calculating cumulative totals:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp, ord, col1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_2, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span>
<span class="line"><span>| GRP | ORD | COL1 | SUM_1 | SUM_2 | SUM_3 |</span></span>
<span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span>
<span class="line"><span>| g1  | a   | 10   | 10    | 10    | 10    |</span></span>
<span class="line"><span>| g1  | b   | 20   | 30    | 30    | 30    |</span></span>
<span class="line"><span>| g1  | c   | 20   | 50    | 50    | 50    |</span></span>
<span class="line"><span>| g2  | a   | 30   | 80    | 30    | 30    |</span></span>
<span class="line"><span>| g2  | b   | 30   | 110   | 60    | 60    |</span></span>
<span class="line"><span>| g2  | c   | 40   | 150   | 100   | 100   |</span></span>
<span class="line"><span>| g3  | a   | 50   | 200   | 50    | 50    |</span></span>
<span class="line"><span>| g3  | b   | 50   | 250   | 100   | 100   |</span></span>
<span class="line"><span>| g3  | c   | 60   | 310   | 160   | 160   |</span></span>
<span class="line"><span>| g3  | d   | 50   | 360   | 210   | 210   |</span></span>
<span class="line"><span>+-----+-----+------+-------+-------+-------+</span></span></code></pre></div><h3 id="example-between-iv-mixed-boundaries-rows" tabindex="-1">Example: BETWEEN IV Mixed Boundaries ROWS <a id="between_preceding_and_following_rows"></a> <a class="header-anchor" href="#example-between-iv-mixed-boundaries-rows" aria-label="Permalink to &quot;Example: BETWEEN IV Mixed Boundaries ROWS &lt;a id=&quot;between_preceding_and_following_rows&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>Moving averages:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp, ord, col1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                        ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                        ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_2, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                        ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_3 </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-----+------+--------+--------+--------+</span></span>
<span class="line"><span>| GRP | ORD | COL1 |  MA_1  |  MA_2  |  MA_3  |</span></span>
<span class="line"><span>+-----+-----+------+--------+--------+--------+</span></span>
<span class="line"><span>| g1  | a   | 10   | 15.000 | 15.000 | 16.666 |</span></span>
<span class="line"><span>| g1  | b   | 20   | 16.666 | 16.666 | 16.666 |</span></span>
<span class="line"><span>| g1  | c   | 20   | 20.000 | 16.666 | 20.000 |</span></span>
<span class="line"><span>| g2  | a   | 30   | 30.000 | 30.000 | 33.333 |</span></span>
<span class="line"><span>| g2  | b   | 30   | 33.333 | 33.333 | 33.333 |</span></span>
<span class="line"><span>| g2  | c   | 40   | 35.000 | 33.333 | 35.000 |</span></span>
<span class="line"><span>| g3  | a   | 50   | 50.000 | 50.000 | 52.500 |</span></span>
<span class="line"><span>| g3  | b   | 50   | 53.333 | 53.333 | 52.500 |</span></span>
<span class="line"><span>| g3  | c   | 60   | 53.333 | 52.500 | 53.333 |</span></span>
<span class="line"><span>| g3  | d   | 50   | 55.000 | 52.500 | 55.000 |</span></span>
<span class="line"><span>+-----+-----+------+--------+--------+--------+</span></span></code></pre></div><h3 id="example-between-v-mixed-boundaries-range" tabindex="-1">Example: BETWEEN V Mixed Boundaries RANGE <a id="between_preceding_and_following_range"></a> <a class="header-anchor" href="#example-between-v-mixed-boundaries-range" aria-label="Permalink to &quot;Example: BETWEEN V Mixed Boundaries RANGE &lt;a id=&quot;between_preceding_and_following_range&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>Please note, this query returns an error:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp, ord, col1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                       RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>Error: invalid window aggregation group in the window specification</span></span></code></pre></div><p>Because, a query in which window frame is defined by <code>RANGE BETWEEN</code> with numeric boundaries can only contain one <code>ORDER BY</code> expression.</p><p>This query will also return an error because the window frame definition of this type requires numeric or timestamp values in the <code>ORDER BY</code> clause.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp, ord, col1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ORDER BY clause is invalid: The ORDER BY clause for window frame &#39;RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING&#39; must have a numeric, date, or timestamp expression.</span></span></code></pre></div><p>Here is a correct query using RANGE window frames:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  grp, id, col1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_1, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_2, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ma_3 </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+----+------+--------+--------+--------+</span></span>
<span class="line"><span>| GRP | ID | COL1 | MA_1   | MA_2   | MA_3   |</span></span>
<span class="line"><span>+-----+----+------+--------+--------+--------+</span></span>
<span class="line"><span>| g1  | 1  | 10   | 15.000 | 15.000 | 16.666 |</span></span>
<span class="line"><span>| g1  | 2  | 20   | 16.666 | 16.666 | 16.666 |</span></span>
<span class="line"><span>| g1  | 3  | 20   | 20.000 | 16.666 | 20.000 |</span></span>
<span class="line"><span>| g2  | 4  | 30   | 30.000 | 30.000 | 33.333 |</span></span>
<span class="line"><span>| g2  | 5  | 30   | 33.333 | 33.333 | 33.333 |</span></span>
<span class="line"><span>| g2  | 6  | 40   | 35.000 | 33.333 | 35.000 |</span></span>
<span class="line"><span>| g3  | 7  | 50   | 50.000 | 50.000 | 52.500 |</span></span>
<span class="line"><span>| g3  | 8  | 50   | 53.333 | 53.333 | 52.500 |</span></span>
<span class="line"><span>| g3  | 9  | 60   | 53.333 | 52.500 | 53.333 |</span></span>
<span class="line"><span>| g3  | 10 | 50   | 55.000 | 52.500 | 55.000 |</span></span>
<span class="line"><span>+-----+----+------+--------+--------+--------+</span></span></code></pre></div><h3 id="example-range-and-rows-between-comparison" tabindex="-1">Example: RANGE and ROWS BETWEEN Comparison <a id="compr_range_and_rows_between_examples"></a> <a class="header-anchor" href="#example-range-and-rows-between-comparison" aria-label="Permalink to &quot;Example: RANGE and ROWS BETWEEN Comparison &lt;a id=&quot;compr_range_and_rows_between_examples&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>In the following example we can see the different behaviour of <code>RANGE</code>-based and <code>ROW</code>-based window frames by calculation of the sums using the same dataset and similar syntax:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        prod_cat,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        product,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum_quarter,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cum_total</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> order by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, product;</span></span></code></pre></div><p>The <code>RANGE</code> window frame syntax calculates the sum of row values for the <em><strong>sale</strong></em> column for partitions defined by the <em><strong>prod_cat</strong></em> column, aggregated per <em><strong>quarter</strong></em> and cummulated over quarters.</p><p>The <code>ROWS</code> window frame syntax calculates the sum of row values for the <em><strong>sale</strong></em> column for partitions defined by the <em><strong>prod_cat</strong></em> column, cummulated over rows.</p><p>The column values are different. Colored lines mark the rows where the <strong>sum_quarter</strong>* and <em><strong>cum_total</strong></em> columns both have equal values.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span>+---------+----------+-------------+------+-------------+-----------+</span></span>
<span class="line"><span>| QUARTER | PROD_CAT | PRODUCT     | SALE | SUM_QUARTER | CUM_TOTAL |</span></span>
<span class="line"><span>+---------+----------+-------------+------+-------------+-----------+</span></span>
<span class="line"><span>| 1       | Hat      | Blue Hat    | 3.5  | 12          | 3.5       |</span></span>
<span class="line"><span>| 1       | Hat      | Red Hat     | 4    | 12          | 7.5       |</span></span>
<span class="line highlighted warning"><span>| 1       | Hat      | Yellow Hat  | 4.5  | 12          | 12        |</span></span>
<span class="line"><span>| 2       | Hat      | Blue Hat    | 2.8  | 19.5        | 14.8      |</span></span>
<span class="line"><span>| 2       | Hat      | Red Hat     | 3.2  | 19.5        | 18        |</span></span>
<span class="line highlighted warning"><span>| 2       | Hat      | Yellow Hat  | 1.5  | 19.5        | 19.5      |</span></span>
<span class="line"><span>| 3       | Hat      | Blue Hat    | 3.3  | 33.1        | 22.8      |</span></span>
<span class="line"><span>| 3       | Hat      | Red Hat     | 4.8  | 33.1        | 27.6      |</span></span>
<span class="line highlighted warning"><span>| 3       | Hat      | Yellow Hat  | 5.5  | 33.1        | 33.1      |</span></span>
<span class="line"><span>| 4       | Hat      | Blue Hat    | 3.5  | 45.2        | 36.6      |</span></span>
<span class="line"><span>| 4       | Hat      | Red Hat     | 4    | 45.2        | 40.6      |</span></span>
<span class="line highlighted warning"><span>| 4       | Hat      | Yellow Hat  | 4.6  | 45.2        | 45.2      |</span></span>
<span class="line"><span>| 1       | Jeans    | Blue Jeans  | 13.5 | 52.6        | 13.5      |</span></span>
<span class="line"><span>| 1       | Jeans    | Green Jeans | 16.5 | 52.6        | 30        |</span></span>
<span class="line highlighted warning"><span>| 1       | Jeans    | Grey Jeans  | 22.6 | 52.6        | 52.6      |</span></span>
<span class="line"><span>| 2       | Jeans    | Blue Jeans  | 12.8 | 107.4       | 65.4      |</span></span>
<span class="line"><span>| 2       | Jeans    | Green Jeans | 10.3 | 107.4       | 75.7      |</span></span>
<span class="line highlighted warning"><span>| 2       | Jeans    | Grey Jeans  | 31.7 | 107.4       | 107.4     |</span></span>
<span class="line"><span>| 3       | Jeans    | Blue Jeans  | 11.4 | 166.5       | 118.8     |</span></span>
<span class="line"><span>| 3       | Jeans    | Green Jeans | 23.8 | 166.5       | 142.6     |</span></span>
<span class="line highlighted warning"><span>| 3       | Jeans    | Grey Jeans  | 23.9 | 166.5       | 166.5     |</span></span>
<span class="line"><span>| 4       | Jeans    | Blue Jeans  | 19.1 | 220.3       | 185.6     |</span></span>
<span class="line"><span>| 4       | Jeans    | Green Jeans | 17.4 | 220.3       | 203       |</span></span>
<span class="line highlighted warning"><span>| 4       | Jeans    | Grey Jeans  | 17.3 | 220.3       | 220.3     |</span></span>
<span class="line"><span>+---------+----------+-------------+------+-------------+-----------+</span></span></code></pre></div><p>The differences arise from different definition of window frame.</p><p>For <code>ROWS</code>-based window frames, current row represents a physical row for which the value is currently being calculated. In our example, the value for the column <em><strong>cum_total</strong></em> is calculated as the sum of the value of the column <em><strong>sale</strong></em> of the current row and all rows before it, implied they belong to the same partition.</p><p>For <code>RANGE</code>-based window frames, all adjacent rows that have the same value in the column <em><strong>quarter</strong></em> and belong to the same partition are included in the window frame used to calculate the <em><strong>sum_quarter</strong></em> value (as if they were all treated as <u>current row</u>). Therefore, the values in the <em><strong>sum_quarter</strong></em> column are the same for any row with the same value in the <em><strong>quarter</strong></em> and <em><strong>prod_cat</strong></em> columns.</p><h3 id="example-supported-non-ranking-window-functions" tabindex="-1">Example: Supported non-ranking Window Functions <a id="supported_non_ranking_funktions"></a> <a class="header-anchor" href="#example-supported-non-ranking-window-functions" aria-label="Permalink to &quot;Example: Supported non-ranking Window Functions &lt;a id=&quot;supported_non_ranking_funktions&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>Return cumulative values over quarter for each <em><strong>product</strong></em>-partition:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    product,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sale, </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) count_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) sum_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) avg_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) min_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MAX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) max_sale</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span>+-------------+------+---------+------------+----------+---------------+----------+----------+</span></span>
<span class="line"><span>| PRODUCT     | SALE | QUARTER | COUNT_SALE | SUM_SALE | AVG_SALE      | MIN_SALE | MAX_SALE |</span></span>
<span class="line"><span>+-------------+------+---------+------------+----------+---------------+----------+----------+</span></span>
<span class="line highlighted warning"><span>| Blue Hat    | 3.5  | 1       | 1          | 3.5      | 3.5           | 3.5      | 3.5      |</span></span>
<span class="line highlighted warning"><span>| Blue Hat    | 2.8  | 2       | 2          | 6.3      | 3.15          | 2.8      | 3.5      |</span></span>
<span class="line highlighted warning"><span>| Blue Hat    | 3.3  | 3       | 3          | 9.6      | 3.2           | 2.8      | 3.5      |</span></span>
<span class="line highlighted warning"><span>| Blue Hat    | 3.5  | 4       | 4          | 13.1     | 3.275         | 2.8      | 3.5      |</span></span>
<span class="line"><span>| Red Hat     | 4    | 1       | 1          | 4        | 4             | 4        | 4        |</span></span>
<span class="line"><span>| Red Hat     | 3.2  | 2       | 2          | 7.2      | 3.6           | 3.2      | 4        |</span></span>
<span class="line"><span>| Red Hat     | 4.8  | 3       | 3          | 12       | 4             | 3.2      | 4.8      |</span></span>
<span class="line"><span>| Red Hat     | 4    | 4       | 4          | 16       | 4             | 3.2      | 4.8      |</span></span>
<span class="line highlighted warning"><span>| Yellow Hat  | 4.5  | 1       | 1          | 4.5      | 4.5           | 4.5      | 4.5      |</span></span>
<span class="line highlighted warning"><span>| Yellow Hat  | 1.5  | 2       | 2          | 6        | 3             | 1.5      | 4.5      |</span></span>
<span class="line highlighted warning"><span>| Yellow Hat  | 5.5  | 3       | 3          | 11.5     | 3.833333333   | 1.5      | 5.5      |</span></span>
<span class="line highlighted warning"><span>| Yellow Hat  | 4.6  | 4       | 4          | 16.1     | 4.025         | 1.5      | 5.5      |</span></span>
<span class="line"><span>| Blue Jeans  | 13.5 | 1       | 1          | 13.5     | 13.5          | 13.5     | 13.5     |</span></span>
<span class="line"><span>| Blue Jeans  | 12.8 | 2       | 2          | 26.3     | 13.15         | 12.8     | 13.5     |</span></span>
<span class="line"><span>| Blue Jeans  | 11.4 | 3       | 3          | 37.7     | 12.566666667  | 11.4     | 13.5     |</span></span>
<span class="line"><span>| Blue Jeans  | 19.1 | 4       | 4          | 56.8     | 14.2          | 11.4     | 19.1     |</span></span>
<span class="line highlighted warning"><span>| Green Jeans | 16.5 | 1       | 1          | 16.5     | 16.5          | 16.5     | 16.5     |</span></span>
<span class="line highlighted warning"><span>| Green Jeans | 10.3 | 2       | 2          | 26.8     | 13.4          | 10.3     | 16.5     |</span></span>
<span class="line highlighted warning"><span>| Green Jeans | 23.8 | 3       | 3          | 50.6     | 16.866666667  | 10.3     | 23.8     |</span></span>
<span class="line highlighted warning"><span>| Green Jeans | 17.4 | 4       | 4          | 68       | 17            | 10.3     | 23.8     |</span></span>
<span class="line"><span>| Grey Jeans  | 22.6 | 1       | 1          | 22.6     | 22.6          | 22.6     | 22.6     |</span></span>
<span class="line"><span>| Grey Jeans  | 31.7 | 2       | 2          | 54.3     | 27.15         | 22.6     | 31.7     |</span></span>
<span class="line"><span>| Grey Jeans  | 23.9 | 3       | 3          | 78.2     | 26.066666667  | 22.6     | 31.7     |</span></span>
<span class="line"><span>| Grey Jeans  | 17.3 | 4       | 4          | 95.5     | 23.875        | 17.3     | 31.7     |</span></span>
<span class="line"><span>+-------------+------+---------+------------+----------+---------------+----------+----------+</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">Please note</p><p>The same results will be produced, if wie modify the query and simplify it:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    product,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sale, </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) count_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) sum_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) avg_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) min_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MAX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) max_sale</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>This is because without explicitly specifying the window frame and defining an <code>ORDER BY</code> clause, <code>ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code> is used as the default value for window frame.</p><p>If you also omit the <code>ORDER BY</code> clause, a different default value is used for the window frame definition and the results are different:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    product,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sale, </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product) count_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product) sum_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product) avg_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product) min_sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MAX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale)   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product) max_sale</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat,product,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">quarter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span>+-------------+------+---------+------------+----------+----------+----------+----------+</span></span>
<span class="line"><span>| PRODUCT     | SALE | QUARTER | COUNT_SALE | SUM_SALE | AVG_SALE | MIN_SALE | MAX_SALE |</span></span>
<span class="line"><span>+-------------+------+---------+------------+----------+----------+----------+----------+</span></span>
<span class="line highlighted warning"><span>| Blue Hat    | 3.5  | 1       | 4          | 13.1     | 3.275    | 2.8      | 3.5      |</span></span>
<span class="line highlighted warning"><span>| Blue Hat    | 2.8  | 2       | 4          | 13.1     | 3.275    | 2.8      | 3.5      |</span></span>
<span class="line highlighted warning"><span>| Blue Hat    | 3.3  | 3       | 4          | 13.1     | 3.275    | 2.8      | 3.5      |</span></span>
<span class="line highlighted warning"><span>| Blue Hat    | 3.5  | 4       | 4          | 13.1     | 3.275    | 2.8      | 3.5      |</span></span>
<span class="line"><span>| Red Hat     | 4    | 1       | 4          | 16       | 4        | 3.2      | 4.8      |</span></span>
<span class="line"><span>| Red Hat     | 3.2  | 2       | 4          | 16       | 4        | 3.2      | 4.8      |</span></span>
<span class="line"><span>| Red Hat     | 4.8  | 3       | 4          | 16       | 4        | 3.2      | 4.8      |</span></span>
<span class="line"><span>| Red Hat     | 4    | 4       | 4          | 16       | 4        | 3.2      | 4.8      |</span></span>
<span class="line highlighted warning"><span>| Yellow Hat  | 4.5  | 1       | 4          | 16.1     | 4.025    | 1.5      | 5.5      |</span></span>
<span class="line highlighted warning"><span>| Yellow Hat  | 1.5  | 2       | 4          | 16.1     | 4.025    | 1.5      | 5.5      |</span></span>
<span class="line highlighted warning"><span>| Yellow Hat  | 5.5  | 3       | 4          | 16.1     | 4.025    | 1.5      | 5.5      |</span></span>
<span class="line highlighted warning"><span>| Yellow Hat  | 4.6  | 4       | 4          | 16.1     | 4.025    | 1.5      | 5.5      |</span></span>
<span class="line"><span>| Blue Jeans  | 13.5 | 1       | 4          | 56.8     | 14.2     | 11.4     | 19.1     |</span></span>
<span class="line"><span>| Blue Jeans  | 12.8 | 2       | 4          | 56.8     | 14.2     | 11.4     | 19.1     |</span></span>
<span class="line"><span>| Blue Jeans  | 11.4 | 3       | 4          | 56.8     | 14.2     | 11.4     | 19.1     |</span></span>
<span class="line"><span>| Blue Jeans  | 19.1 | 4       | 4          | 56.8     | 14.2     | 11.4     | 19.1     |</span></span>
<span class="line highlighted warning"><span>| Green Jeans | 16.5 | 1       | 4          | 68       | 17       | 10.3     | 23.8     |</span></span>
<span class="line highlighted warning"><span>| Green Jeans | 10.3 | 2       | 4          | 68       | 17       | 10.3     | 23.8     |</span></span>
<span class="line highlighted warning"><span>| Green Jeans | 23.8 | 3       | 4          | 68       | 17       | 10.3     | 23.8     |</span></span>
<span class="line highlighted warning"><span>| Green Jeans | 17.4 | 4       | 4          | 68       | 17       | 10.3     | 23.8     |</span></span>
<span class="line"><span>| Grey Jeans  | 22.6 | 1       | 4          | 95.5     | 23.875   | 17.3     | 31.7     |</span></span>
<span class="line"><span>| Grey Jeans  | 31.7 | 2       | 4          | 95.5     | 23.875   | 17.3     | 31.7     |</span></span>
<span class="line"><span>| Grey Jeans  | 23.9 | 3       | 4          | 95.5     | 23.875   | 17.3     | 31.7     |</span></span>
<span class="line"><span>| Grey Jeans  | 17.3 | 4       | 4          | 95.5     | 23.875   | 17.3     | 31.7     |</span></span>
<span class="line"><span>+-------------+------+---------+------------+----------+----------+----------+----------+</span></span></code></pre></div><p>If window frame definition and also <code>ORDER BY</code> clause are omitted, <code>RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING</code> is used as window border definition. The implied order of the rows in the table is retained.</p></div><h3 id="example-assymetric-boundaries" tabindex="-1">Example: &quot;Assymetric&quot; Boundaries <a id="assymetric_boundaries"></a> <a class="header-anchor" href="#example-assymetric-boundaries" aria-label="Permalink to &quot;Example: &quot;Assymetric&quot; Boundaries &lt;a id=&quot;assymetric_boundaries&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>With this example we show that window frame does not necessarily have to enclose the current row.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       ord,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       col1,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) sum_preceding,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ord </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) sum_following</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp, ord;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-----+------+---------------+---------------+</span></span>
<span class="line"><span>| GRP | ORD | COL1 | SUM_PRECEDING | SUM_FOLLOWING |</span></span>
<span class="line"><span>+-----+-----+------+---------------+---------------+</span></span>
<span class="line"><span>| g1  | a   | 10   | null          | 40            |</span></span>
<span class="line"><span>| g1  | b   | 20   | 10            | 20            |</span></span>
<span class="line"><span>| g1  | c   | 20   | 30            | null          |</span></span>
<span class="line"><span>| g2  | a   | 30   | null          | 70            |</span></span>
<span class="line"><span>| g2  | b   | 30   | 30            | 40            |</span></span>
<span class="line"><span>| g2  | c   | 40   | 60            | null          |</span></span>
<span class="line"><span>| g3  | a   | 50   | null          | 110           |</span></span>
<span class="line"><span>| g3  | b   | 50   | 50            | 110           |</span></span>
<span class="line"><span>| g3  | c   | 60   | 100           | 50            |</span></span>
<span class="line"><span>| g3  | d   | 50   | 110           | null          |</span></span>
<span class="line"><span>+-----+-----+------+---------------+---------------+</span></span></code></pre></div><p><code>NULL</code> values occur where calculations are performed for rows that are located at the beginning or end of a partition. The sum of the preceding or following rows is zero because the rows are outside the window frame and column values for them are <code>NULL</code>.</p><h3 id="example-using-group-by-with-window-functions" tabindex="-1">Example: Using GROUP BY with Window Functions <a id="using_group_by_with_window_functions"></a> <a class="header-anchor" href="#example-using-group-by-with-window-functions" aria-label="Permalink to &quot;Example: Using GROUP BY with Window Functions &lt;a id=&quot;using_group_by_with_window_functions&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>The <code>GROUP BY</code> clause does not affect window function calculations. It can be used in the same query as the window function. Note: If you use the <code>GROUP BY</code> clause in a query in which you use a window function, all columns that you include in the <code>SELECT</code> clause, except the results of the window function result column, must be included in the <code>GROUP BY</code> clause.</p><p>The results will be the same, as without <code>GROUP BY</code> clause.</p><p>In this example, we calculate the average of all products whose <em><strong>SALE</strong></em> is at least <em><strong>10</strong></em> greater than <em><strong>SALE</strong></em> of the current row.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    product, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> average</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line highlighted warning"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat, product, sale   </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sale;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- AND </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    product, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> average</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span></span>
<span class="line highlighted warning"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Jeans&#39;</span></span>
<span class="line highlighted warning"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sale;            </span></span></code></pre></div><p>Have the same result.</p><p>For example, the first row of the output table (row 4), the row with <em><strong>PROD_CAT = &#39;Jeans&#39;</strong></em> and <em><strong>PRODUCT = &#39;Blue Jeans&#39;</strong></em> and <em><strong>SALE = 10.3</strong></em>, has the value <em><strong>14.7875</strong></em> in the <em><strong>AVERAGE</strong></em> column. To calculate the <em><strong>AVERAGE = 14.7875</strong></em>, values were used that lie between <em><strong>10.3</strong></em> (<em><strong>SALE</strong></em> value of the <u>current row</u>) and <em><strong>10.3 + 10</strong></em> (inclusive): (10.3 + 11.4 + 12.8 + 13.5 + 16.5 + 17.3 + 17.4 + 19.1)/8 = 14.7875.</p><p>Last row (row 15) contains the value <em><strong>31.7</strong></em> in both columns <em><strong>SALE</strong></em> and <em><strong>AVERAGE</strong></em>. This is because window frame for this row consists of the rows with the <em><strong>SALE</strong></em> values that are between <em><strong>31.7</strong></em> (inclusive) (<em><strong>SALE</strong></em> value of the <u>current row</u>) and <em><strong>31.7 + 10</strong></em> (inclusive). Since there is only one such value, the result is the value itself.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+----------+-------------+------+--------------+</span></span>
<span class="line"><span>| PROD_CAT | PRODUCT     | SALE | AVERAGE      |</span></span>
<span class="line"><span>+----------+-------------+------+--------------+</span></span>
<span class="line"><span>| Jeans    | Green Jeans | 10.3 | 14.7875      |</span></span>
<span class="line"><span>| Jeans    | Blue Jeans  | 11.4 | 15.428571429 |</span></span>
<span class="line"><span>| Jeans    | Blue Jeans  | 12.8 | 17.028571429 |</span></span>
<span class="line"><span>| Jeans    | Blue Jeans  | 13.5 | 17.733333333 |</span></span>
<span class="line"><span>| Jeans    | Green Jeans | 16.5 | 20.085714286 |</span></span>
<span class="line"><span>| Jeans    | Grey Jeans  | 17.3 | 20.683333333 |</span></span>
<span class="line"><span>| Jeans    | Green Jeans | 17.4 | 21.36        |</span></span>
<span class="line"><span>| Jeans    | Blue Jeans  | 19.1 | 22.35        |</span></span>
<span class="line"><span>| Jeans    | Grey Jeans  | 22.6 | 25.5         |</span></span>
<span class="line"><span>| Jeans    | Green Jeans | 23.8 | 26.466666667 |</span></span>
<span class="line"><span>| Jeans    | Grey Jeans  | 23.9 | 27.8         |</span></span>
<span class="line"><span>| Jeans    | Grey Jeans  | 31.7 | 31.7         |</span></span>
<span class="line"><span>+----------+-------------+------+--------------+</span></span></code></pre></div><p>This query returns an error, because the column <em><strong>sale</strong></em> is specified in the <code>SELECT</code> clause but not in the <code>GROUP BY</code> clause.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    product, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sale,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sale) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> average</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Jeans&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prod_cat, product</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sale;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>[MY_TABLE2.SALE] is not a valid group by expression</span></span></code></pre></div><p>For more information, see <a href="#range_based_window_frames_details">RANGE-based window frames</a>.</p><h3 id="example-handling-of-null-values" tabindex="-1">Example: Handling of NULL values <a id="handling_of_null_values_examples"></a> <a class="header-anchor" href="#example-handling-of-null-values" aria-label="Permalink to &quot;Example: Handling of NULL values &lt;a id=&quot;handling_of_null_values_examples&quot;&gt;&lt;/a&gt;&quot;"></a></h3><p>See also <a href="#ordering_the_rows">ORDER BY clause</a>.</p><p>In general, it is recommended to avoid <code>NULL</code> values in the <em><strong>order_expr</strong></em>, because depending on the window frame definition, it can lead to unexpected results.</p><p>Here we show, using two different window frame definitions as examples, what effects the <code>NULLS FIRST</code> and <code>NULLS LAST</code> settings in the <code>ORDER BY</code> clause within the <code>OVER()</code> clause can have.</p><p>With <code>NULLS LAST</code>:</p><ul><li>With the window frame definition with explicit offsets, lines with NULL in <em><strong>order_expr</strong></em> are included in the frame if the <em><strong>order_expr</strong></em> of the <u><i>current line</i></u> is <code>NULL</code>.</li><li>With the window frame definition with <code>UNBOUNDED FOLLOWING</code>, lines with <code>NULL</code> in <em><strong>order_expr</strong></em> are included in the frame.</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp2, col2,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col2) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NULLS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LAST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) sum_1,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(col2) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NULLS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LAST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> RANGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOLLOWING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) sum_2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> my_folder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">my_table</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grp2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NULLS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LAST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+------+------+-------+-------+</span></span>
<span class="line"><span>| GRP2 | COL2 | SUM_1 | SUM_2 |</span></span>
<span class="line"><span>+------+------+-------+-------+</span></span>
<span class="line"><span>| 1    | 10   | 135   | 373   |</span></span>
<span class="line"><span>| 1    | 20   | 135   | 373   |</span></span>
<span class="line"><span>| 2    | 30   | 235   | 373   |</span></span>
<span class="line"><span>| 2    | 35   | 235   | 373   |</span></span>
<span class="line"><span>| 2    | 40   | 235   | 373   |</span></span>
<span class="line"><span>| 3    | 45   | 205   | 343   |</span></span>
<span class="line"><span>| 3    | 55   | 205   | 343   |</span></span>
<span class="line"><span>| NULL | 25   | 138   | 138   |</span></span>
<span class="line"><span>| NULL | 53   | 138   | 138   |</span></span>
<span class="line"><span>| NULL | 60   | 138   | 138   |</span></span>
<span class="line"><span>+------+------+-------+-------+</span></span></code></pre></div><p>For rows with <em><strong>GRP2 = 1</strong></em>, <em><strong>SUM_1</strong></em> is calculated as (10 + 20) + (30 + 35 + 40) = 135. The values with <em><strong>GRP2</strong></em> = <code>NULL</code> are not included in the window frame. The rows with <em><strong>GRP2 = 2</strong></em> and <em><strong>3</strong></em> also do not include rows with <em><strong>GRP2</strong></em> = <code>NULL</code> values in the calculated totals.</p><p>The last three rows with <em><strong>GRP2</strong></em> = <code>NULL</code> form a &quot;separate&quot; window frame.</p><p>For <em><strong>SUM_2</strong></em> and <em><strong>GRP2 = 1</strong></em>, the result is (10 + 20) + (30 + 35 + 40) + (45 + 55) + (25 + 53 + 60) = 373, since all subsequent rows with <code>UNBOUNDED FOLLOWING</code> are included in the calculation and rows with <em><strong>GRP2</strong></em> = <code>NULL</code> are sorted to the end of the table.</p><h2 id="ranking-window-functions" tabindex="-1">Ranking window functions <a class="header-anchor" href="#ranking-window-functions" aria-label="Permalink to &quot;Ranking window functions&quot;"></a></h2><p>The syntax for a ranking window function is essentially the same as the syntax for other window functions. The exceptions include: Ranking window functions require the ORDER BY clause inside the OVER clause. For some ranking functions, such as RANK itself, no input argument is required. For the RANK function, the value returned is based solely on numeric ranking, as determined by the ORDER BY clause inside the OVER clause. Therefore, passing a column name or expression to the function is unnecessary. The simplest ranking function is named RANK. You can use this function to: Rank salespeople on revenue (sales), from highest to lowest. Rank countries based on their per-capita GDP (income per person), from highest to lowest. Rank countries on air pollution, from lowest to highest. This function simply identifies the numeric ranking position of a row in an ordered set of rows. The first row has rank 1, the second has rank 2, and so on. The following example shows the rank order of salespeople based on Amount Sold:</p><table><thead><tr><th>Salesperson</th><th>Amount Sold</th><th>Rank</th></tr></thead><tbody><tr><td>Smith</td><td>2000</td><td>1</td></tr><tr><td>Jones</td><td>1500</td><td>2</td></tr><tr><td>Torkelson</td><td>1200</td><td>3</td></tr><tr><td>Dolenz</td><td>1100</td><td>4</td></tr></tbody></table><p>The rows must already be sorted before the rankings can be assigned. Therefore, you must use an ORDER BY clause within the OVER clause. Consider the following example: youd like to know where your store profit ranks among branches of the store chain (whether your store ranks first, second, third, and so on). This example ranks each store by profitability within its city. The rows are put in descending order (highest profit first), so the most profitable store is ranked 1:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city, branch_ID, net_profit,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> net_profit </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rank</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store_sales</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city, rank;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----------+-----------+------------+------+</span></span>
<span class="line"><span>| CITY   | BRANCH_ID | NET_PROFIT | RANK |</span></span>
<span class="line"><span>|-----------+-----------+------------+------|</span></span>
<span class="line"><span>| Montreal |     3 |  10000.00 |  1 |</span></span>
<span class="line"><span>| Montreal |     4 |  9000.00 |  2 |</span></span>
<span class="line"><span>| Vancouver |     2 |  15000.00 |  1 |</span></span>
<span class="line"><span>| Vancouver |     1 |  10000.00 |  2 |</span></span>
<span class="line"><span>+-----------+-----------+------------+------+</span></span></code></pre></div><p>Note</p><p>The net_profit column does not need to be passed as an argument to the RANK function. Instead, the input rows are sorted by net_profit. The RANK function merely needs to return the position of the row (1, 2, 3, and so on) within the partition. The output of a ranking function depends on: The individual row passed to the function. The values of the other rows in the partition. The order of all the rows in the partition. Snowflake provides several different ranking functions. For a list of these functions, and more details about their syntax, see Window functions. To rank your store against all other stores in the chain, not just against other stores in your city, use the query below:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  branch_ID,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  net_profit,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> net_profit </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_rank</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store_sales;</span></span></code></pre></div><p>The following query uses the first ORDER BY clause to control processing by the window function and the second ORDER BY clause to control the order of the entire querys output:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  branch_ID,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  net_profit,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> net_profit </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_rank</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store_sales</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> branch_ID;</span></span></code></pre></div><h2 id="illustrated-example" tabindex="-1">Illustrated example <a class="header-anchor" href="#illustrated-example" aria-label="Permalink to &quot;Illustrated example&quot;"></a></h2><p>This example uses a sales scenario to illustrate many of the concepts described earlier in this topic. Suppose that you need to generate a financial report that shows values based on sales over the last week: Daily sales Ranking within the week (that is, sales ranked highest to lowest for the week) Sales so far this week (that is, the cumulative sum for all days from the beginning of the week up through and including the current day) Total sales for the week Three-day moving average (that is, the average over the current day and the two previous days) The report might look something like this:</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+--------+-------+------+--------------+-------------+--------------+</span></span>
<span class="line"><span>| Day of | Sales | Rank | Sales So Far | Total Sales | 3-Day Moving |</span></span>
<span class="line"><span>| Week  | Today |   | This Week  | This Week  | Average   |</span></span>
<span class="line"><span>|--------+-------+------+--------------+-------------|--------------+</span></span>
<span class="line"><span>|   1 |  10 |  4 |      10 |     84 |     10.0 |</span></span>
<span class="line"><span>|   2 |  14 |  3 |      24 |     84 |     12.0 |</span></span>
<span class="line"><span>|   3 |   6 |  5 |      30 |     84 |     10.0 |</span></span>
<span class="line"><span>|   4 |   6 |  5 |      36 |     84 |     9.0 |</span></span>
<span class="line"><span>|   5 |  14 |  3 |      50 |     84 |     10.0 |</span></span>
<span class="line"><span>|   6 |  16 |  2 |      66 |     84 |     11.0 |</span></span>
<span class="line"><span>|   7 |  18 |  1 |      84 |     84 |     12.0 |</span></span>
<span class="line"><span>+--------+-------+------+--------------+-------------+--------------+</span></span></code></pre></div><p>The SQL for this query is somewhat complex. Rather than show the example as a single query, this discussion breaks down the SQL for the individual columns. In a real-world scenario, you would have years of data, so to calculate sums and averages for one specific week of data, you would need to use a one-week window, or use a filter similar to: ... WHERE date &gt;= start_of_relevant_week and date &lt;= end_of_relevant_week ... However, for this example, assume that the table contains only the most recent weeks worth of data.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> store_sales_2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  day</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INTEGER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  sales_today </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INTEGER</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-------------------------------------------+</span></span>
<span class="line"><span>| status                  |</span></span>
<span class="line"><span>|-------------------------------------------|</span></span>
<span class="line"><span>| Table STORE_SALES_2 successfully created. |</span></span>
<span class="line"><span>+-------------------------------------------+</span></span></code></pre></div><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store_sales_2 (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sales_today) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-------------------------+</span></span>
<span class="line"><span>| number of rows inserted |</span></span>
<span class="line"><span>|-------------------------|</span></span>
<span class="line"><span>|            7 |</span></span>
<span class="line"><span>+-------------------------+</span></span></code></pre></div><h2 id="calculating-sales-rank" tabindex="-1">Calculating sales rank <a class="header-anchor" href="#calculating-sales-rank" aria-label="Permalink to &quot;Calculating sales rank&quot;"></a></h2><p>The Rank column is calculated using the RANK function:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   sales_today, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_today </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Rank</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store_sales_2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-------------+------+</span></span>
<span class="line"><span>| DAY | SALES_TODAY | RANK |</span></span>
<span class="line"><span>|-----+-------------+------|</span></span>
<span class="line"><span>|  1 |     10 |  5 |</span></span>
<span class="line"><span>|  2 |     14 |  3 |</span></span>
<span class="line"><span>|  3 |      6 |  6 |</span></span>
<span class="line"><span>|  4 |      6 |  6 |</span></span>
<span class="line"><span>|  5 |     14 |  3 |</span></span>
<span class="line"><span>|  6 |     16 |  2 |</span></span>
<span class="line"><span>|  7 |     18 |  1 |</span></span>
<span class="line"><span>+-----+-------------+------+</span></span></code></pre></div><p>Although there are 7 days in the time period, there are only 5 different ranks (1, 2, 3, 5, 6). There were two ties (for 3rd place and 6th place), so there are no rows with ranks 4 or 7. Calculating sales so far this week The Sales So Far This Week column is calculated using SUM as a window function with a window frame:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   sales_today, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sales_today)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SALES SO FAR THIS WEEK&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store_sales_2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-------------+------------------------+</span></span>
<span class="line"><span>| DAY | SALES_TODAY | SALES SO FAR THIS WEEK |</span></span>
<span class="line"><span>|-----+-------------+------------------------|</span></span>
<span class="line"><span>|  1 |     10 |           10 |</span></span>
<span class="line"><span>|  2 |     14 |           24 |</span></span>
<span class="line"><span>|  3 |      6 |           30 |</span></span>
<span class="line"><span>|  4 |      6 |           36 |</span></span>
<span class="line"><span>|  5 |     14 |           50 |</span></span>
<span class="line"><span>|  6 |     16 |           66 |</span></span>
<span class="line"><span>|  7 |     18 |           84 |</span></span>
<span class="line"><span>+-----+-------------+------------------------+</span></span></code></pre></div><p>This query orders the rows by date and then, for each date, calculates the sum of sales from the start of the window up to the current date (inclusive).</p><h2 id="calculating-total-sales-this-week" tabindex="-1">Calculating total sales this week <a class="header-anchor" href="#calculating-total-sales-this-week" aria-label="Permalink to &quot;Calculating total sales this week&quot;"></a></h2><p>The Total Sales This Week column is calculated using SUM.</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   sales_today, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sales_today)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_sales</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store_sales_2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-------------+-------------+</span></span>
<span class="line"><span>| DAY | SALES_TODAY | TOTAL_SALES |</span></span>
<span class="line"><span>|-----+-------------+-------------|</span></span>
<span class="line"><span>|  1 |     10 |     84 |</span></span>
<span class="line"><span>|  2 |     14 |     84 |</span></span>
<span class="line"><span>|  3 |      6 |     84 |</span></span>
<span class="line"><span>|  4 |      6 |     84 |</span></span>
<span class="line"><span>|  5 |     14 |     84 |</span></span>
<span class="line"><span>|  6 |     16 |     84 |</span></span>
<span class="line"><span>|  7 |     18 |     84 |</span></span>
<span class="line"><span>+-----+-------------+-------------+</span></span></code></pre></div><h2 id="calculating-a-three-day-moving-average" tabindex="-1">Calculating a three-day moving average <a class="header-anchor" href="#calculating-a-three-day-moving-average" aria-label="Permalink to &quot;Calculating a three-day moving average&quot;"></a></h2><p>The 3-Day Moving Average column is calculated using AVG as a window function with a window frame:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   sales_today, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sales_today)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;3-DAY MOVING AVERAGE&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store_sales_2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-------------+----------------------+</span></span>
<span class="line"><span>| DAY | SALES_TODAY | 3-DAY MOVING AVERAGE |</span></span>
<span class="line"><span>|-----+-------------+----------------------|</span></span>
<span class="line"><span>|  1 |     10 |        10.000 |</span></span>
<span class="line"><span>|  2 |     14 |        12.000 |</span></span>
<span class="line"><span>|  3 |      6 |        10.000 |</span></span>
<span class="line"><span>|  4 |      6 |        8.666 |</span></span>
<span class="line"><span>|  5 |     14 |        8.666 |</span></span>
<span class="line"><span>|  6 |     16 |        12.000 |</span></span>
<span class="line"><span>|  7 |     18 |        16.000 |</span></span>
<span class="line"><span>+-----+-------------+----------------------+</span></span></code></pre></div><p>The difference between this window frame and the window frame described earlier is the starting point: a fixed boundary versus an explicit offset.</p><h2 id="putting-it-all-together" tabindex="-1">Putting it all together <a class="header-anchor" href="#putting-it-all-together" aria-label="Permalink to &quot;Putting it all together&quot;"></a></h2><p>Heres the final version of the query, showing all of the columns:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   sales_today, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_today </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Rank,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sales_today)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNBOUNDED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SALES SO FAR THIS WEEK&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sales_today)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_sales,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sales_today)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ROWS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BETWEEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRECEDING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ROW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;3-DAY MOVING AVERAGE&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store_sales_2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+-----+-------------+------+------------------------+-------------+----------------------+</span></span>
<span class="line"><span>| DAY | SALES_TODAY | RANK | SALES SO FAR THIS WEEK | TOTAL_SALES | 3-DAY MOVING AVERAGE |</span></span>
<span class="line"><span>|-----+-------------+------+------------------------+-------------+----------------------|</span></span>
<span class="line"><span>|  1 |     10 |  5 |           10 |     84 |        10.000 |</span></span>
<span class="line"><span>|  2 |     14 |  3 |           24 |     84 |        12.000 |</span></span>
<span class="line"><span>|  3 |      6 |  6 |           30 |     84 |        10.000 |</span></span>
<span class="line"><span>|  4 |      6 |  6 |           36 |     84 |        8.666 |</span></span>
<span class="line"><span>|  5 |     14 |  3 |           50 |     84 |        8.666 |</span></span>
<span class="line"><span>|  6 |     16 |  2 |           66 |     84 |        12.000 |</span></span>
<span class="line"><span>|  7 |     18 |  1 |           84 |     84 |        16.000 |</span></span>
<span class="line"><span>+-----+-------------+------+------------------------+-------------+----------------------+</span></span></code></pre></div><h2 id="ranking-function-examples" tabindex="-1">Ranking function examples <a class="header-anchor" href="#ranking-function-examples" aria-label="Permalink to &quot;Ranking function examples&quot;"></a></h2><p>The following example shows how to rank sales based on the total amount (in dollars) that each salesperson has sold. The ORDER BY clause within the OVER clause sorts the totals in descending order (highest to lowest). The query calculates the rank of each salesperson relative to all other salespeople. Create the table and insert the data:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sales_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (salesperson_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sales_in_dollars </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INTEGER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_table (salesperson_name, sales_in_dollars) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Smith&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jones&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Torkelson&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">700</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Dolenz&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Now query the data:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  salesperson_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  sales_in_dollars,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_in_dollars </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_rank</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_table;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+------------------+------------------+------------+</span></span>
<span class="line"><span>| SALESPERSON_NAME | SALES_IN_DOLLARS | SALES_RANK |</span></span>
<span class="line"><span>|------------------+------------------+------------|</span></span>
<span class="line"><span>| Jones      |       1000 |     1 |</span></span>
<span class="line"><span>| Dolenz      |       800 |     2 |</span></span>
<span class="line"><span>| Torkelson    |       700 |     3 |</span></span>
<span class="line"><span>| Smith      |       600 |     4 |</span></span>
<span class="line"><span>+------------------+------------------+------------+</span></span></code></pre></div><p>The output is not necessarily ordered by rank. To display reults ordered by rank, specify an ORDER BY clause for the query itself (in addition to the ORDER BY clause for the window function), as shown here:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  salesperson_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  sales_in_dollars,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_in_dollars </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_rank</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_table</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+------------------+------------------+------------+</span></span>
<span class="line"><span>| SALESPERSON_NAME | SALES_IN_DOLLARS | SALES_RANK |</span></span>
<span class="line"><span>|------------------+------------------+------------|</span></span>
<span class="line"><span>| Jones      |       1000 |     1 |</span></span>
<span class="line"><span>| Dolenz      |       800 |     2 |</span></span>
<span class="line"><span>| Torkelson    |       700 |     3 |</span></span>
<span class="line"><span>| Smith      |       600 |     4 |</span></span>
<span class="line"><span>+------------------+------------------+------------+</span></span></code></pre></div><p>The preceding example has two ORDER BY clauses: One controls the order of the ranking. One controls the order of the output. These clauses are independent. For example, you could order the rankings based on total sales (as shown above), but order the output rows based on the salespersons last name:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  salesperson_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  sales_in_dollars,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_in_dollars </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_rank</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sales_table</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> salesperson_name;</span></span></code></pre></div><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>+------------------+------------------+------------+</span></span>
<span class="line"><span>| SALESPERSON_NAME | SALES_IN_DOLLARS | SALES_RANK |</span></span>
<span class="line"><span>|------------------+------------------+------------|</span></span>
<span class="line"><span>| Dolenz      |       800 |     2 |</span></span>
<span class="line"><span>| Jones      |       1000 |     1 |</span></span>
<span class="line"><span>| Smith      |       600 |     4 |</span></span>
<span class="line"><span>| Torkelson    |       700 |     3 |</span></span>
<span class="line"><span>+------------------+------------------+------------+</span></span></code></pre></div>`,185);function y(f,m,u,F,_,D){const a=t("Badge");return r(),l("div",null,[k,p(a,{type:"warning",text:" ! ",style:{"text-indent":"0em"}}),s(" However, the "),d,s(" clause can have a different meaning in different window frame types. For more information see "),c,s(", "),E,s(" and "),o,s("."),g])}const A=n(h,[["render",y]]);export{b as __pageData,A as default};
